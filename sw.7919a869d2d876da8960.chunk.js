(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{if(void 0!==e){var t=e.u,n=e.e,o=new Map,r=new Map;e.u=function(e){return t(e)+(o.has(e)?"?"+o.get(e):"")},e.e=function(i){return n(i).catch((function(n){var s=r.has(i)?r.get(i):999999;if(s<1){var a=t(i);throw n.message="Loading chunk "+i+" failed after 999999 retries.\n("+a+")",n.request=a,n}return new Promise((function(t){setTimeout((function(){var n=Date.now();o.set(i,n),r.set(i,s-1),t(e.e(i))}),3e3)}))}))}}})(),e.d({},{T:()=>Q,c:()=>H});const t={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,multipleConnections:!0,asServiceWorker:!1,transport:"websocket"};t.http=location.search.indexOf("http=1")>0,t.http&&(t.transport="https");const n=t,o=n.debug,r=("undefined"!=typeof window?window:self,o),i="undefined"!=typeof window?window:self,s=navigator?navigator.userAgent:null,a=(navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i),navigator.userAgent.toLowerCase().indexOf("android"),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&i.MSStream,!!("safari"in i)||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))),c=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,l=(navigator.maxTouchPoints>0&&navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i),"undefined"!=typeof ServiceWorkerGlobalScope&&self instanceof ServiceWorkerGlobalScope),u="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&!l,h=()=>self.clients.matchAll({includeUncontrolled:!1,type:"window"}),d=(e,...t)=>{try{e.postMessage(...t)}catch(e){console.error("[worker] postMessage error:",e,t)}},f=(e,...t)=>{h().then((n=>{n.length&&n.slice(e?0:-1).forEach((e=>{d(e,...t)}))}))},g=(l&&f.bind(null,!1),l&&f.bind(null,!0),Date.now());function p(){return"["+((Date.now()-g)/1e3).toFixed(3)+"]"}var m;!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Log=4]="Log",e[e.Debug=8]="Debug"}(m||(m={}));const v=[m.None,m.Error,m.Warn,m.Log,m.Debug],w=!(a||c),y="[33m",b="[36m",P=[["debug",m.Debug],["info",m.Log],["warn",m.Warn],["error",m.Error],["assert",m.Error],["trace",m.Log],["group",m.Log],["groupCollapsed",m.Log],["groupEnd",m.Log]];function S(e,t=m.Log|m.Warn|m.Error,n=!1,o=""){let i;r||n||(t=m.Error),w?o||(l?o=y:u&&(o=b)):o="";let s=o;o=o?`%s ${o}%s`:"%s";const a=function(...n){return t&m.Log&&console.log(o,p(),e,...n)};return P.forEach((([n,r])=>{a[n]=function(...i){return t&r&&console[n](o,p(),e,...i)}})),a.setPrefix=function(t){i=t,e="["+t+"]"},a.setPrefix(e),a.setLevel=function(e){t=v.slice(0,e+1).reduce(((e,t)=>e|t),0)},a.bindPrefix=function(e){return S(`${i}] [${e}`,t,n,s)},a}const A=self,O="cachedAssets";function T(e){return e.ok&&200===e.status}function E(e){return Promise.race([e,(1e4,new Promise((e=>{setTimeout(e,1e4)}))).then((()=>Promise.reject()))])}function x(){}function C(e,t=""){let n;Array.isArray(e)||(e=[e]);const o=function(e){return-1===["image/jpeg","image/png","image/gif","image/svg+xml","image/webp","image/bmp","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","audio/wav","application/json","application/pdf"].indexOf(e)?"application/octet-stream":e}(t);try{n=new Blob(e,{type:o})}catch(t){let r=new BlobBuilder;e.forEach((e=>{r.append(e)})),n=r.getBlob(o)}return n}const _=new class{constructor(){this.blobSupported=!0;try{C([],"")}catch(e){this.blobSupported=!1}}isAvailable(){return this.blobSupported}getFakeFileWriter(e,t,n){let o=new Uint8Array(t);const r={write:(e,t)=>{return n=this,r=void 0,s=function*(){if(!this.blobSupported)throw!1;o.set(e,t)},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}c((s=s.apply(n,r||[])).next())}));var n,r,i,s},truncate:()=>{o=new Uint8Array},trim:e=>{o=o.slice(0,e)},finalize:(t=!0)=>{const r=C(o,e);return t&&n&&n(r),r},getParts:()=>o,replaceParts:e=>{o=e}};return r}};class j{constructor(e){this.dbName=e,this.useStorage=!0,n.test&&(this.dbName+="_test"),j.STORAGES.length&&(this.useStorage=j.STORAGES[0].useStorage),this.openDatabase(),j.STORAGES.push(this)}openDatabase(){var e;return null!==(e=this.openDbPromise)&&void 0!==e?e:this.openDbPromise=caches.open(this.dbName)}delete(e){return this.timeoutOperation((t=>t.delete("/"+e)))}deleteAll(){return caches.delete(this.dbName)}get(e){return this.timeoutOperation((t=>t.match("/"+e)))}save(e,t){return this.timeoutOperation((n=>n.put("/"+e,t)))}getFile(e,t="blob"){return this.get(e).then((e=>{if(!e)throw"NO_ENTRY_FOUND";return e[t]()}))}saveFile(e,t){t instanceof Blob||(t=C(t));const n=new Response(t,{headers:{"Content-Length":""+t.size}});return this.save(e,n).then((()=>t))}timeoutOperation(e){return this.useStorage?new Promise(((t,n)=>{return o=this,r=void 0,s=function*(){let o=!1;const r=setTimeout((()=>{n(),o=!0}),15e3);try{const n=yield this.openDatabase();if(!n)throw this.useStorage=!1,this.openDbPromise=void 0,"no cache?";const r=yield e(n);if(o)return;t(r)}catch(e){n(e)}clearTimeout(r)},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,a)}c((s=s.apply(o,r||[])).next())}));var o,r,i,s})):Promise.reject("STORAGE_OFFLINE")}getFileWriter(e,t,n){const o=_.getFakeFileWriter(n,t,(t=>this.saveFile(e,t).catch((()=>t))));return Promise.resolve(o)}static toggleStorage(e,t){return Promise.all(this.STORAGES.map((n=>{if(n.useStorage=e,t)return e?void 0:n.deleteAll()})))}}j.STORAGES=[];const k=new j("cachedStreamChunks"),N="Time-Cached";setInterval((()=>k.timeoutOperation((e=>e.keys().then((t=>{const n=new Map,o=Date.now()/1e3|0;for(const e of t){const t=e.url.match(/\/(\d+?)\?/);t&&!n.has(t[1])&&n.set(t[1],e)}const r=[];for(const[t,i]of n){const n=e.match(i).then((n=>{if(+n.headers.get(N)+86400<=o)return H("will delete stream chunk:",t),e.delete(i,{ignoreSearch:!0,ignoreVary:!0})}));r.push(n)}return Promise.all(r)}))))),18e5),setInterval((()=>{h().then((e=>{for(const[t,n]of Q)if(!e.find((e=>e.id===t))){for(const e in n)n[e].reject();Q.delete(t)}}))}),12e4);const D=new Map;class I{constructor(e){this.info=e,this.loadedOffsets=new Set,this.destroy=()=>{D.delete(this.id)},this.id=I.getId(e),D.set(this.id,this),this.limitPart=e.size>78643200?L:F,this.destroyDebounced=function(e,t,n=!0,o=!0){let r,s,a,c,l=!1;const u=t=>{const n=a,o=c;try{n(e.apply(null,t))}catch(e){console.error("debounce error",e),o(e)}},h=(...e)=>{s||(s=new Promise(((e,t)=>(a=e,c=t)))),r?(clearTimeout(r),l=!0,c(),s=new Promise(((e,t)=>(a=e,c=t)))):n&&(u(e),l=!1);const h=i.setTimeout((()=>{!o||n&&!l||u(e),r===h&&(r=s=a=c=void 0,l=!1)}),t);return r=h,s.catch(x),s};return h.clearTimeout=()=>{r&&(i.clearTimeout(r),c(),r=s=a=c=void 0,l=!1)},h}(this.destroy,15e4,!1,!0)}requestFilePartFromWorker(e,t,n=!1){return o=this,r=void 0,s=function*(){const o={type:"requestFilePart",payload:{docId:this.id,dcId:this.info.dcId,offset:e,limit:t}},r=JSON.stringify(o);o.id=r;const i=yield h().then((e=>{if(e.length)return e.find((e=>Q.has(e.id)))||e[0]}));if(!i)throw new Error("no window");let s=Q.get(i.id);s||Q.set(i.id,s={});let a=s[r];if(a)return a.then((e=>e.bytes));i.postMessage(o),this.loadedOffsets.add(e),a=s[r]=function(){let e={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:(...t)=>{e.lastNotify=t,e.listeners.forEach((e=>e(...t)))},listeners:[],addNotifyListener:t=>{e.lastNotify&&t(...e.lastNotify),e.listeners.push(t)}},t=new Promise(((n,o)=>{e.resolve=e=>{t.isFulfilled||t.isRejected||(t.isFulfilled=!0,n(e))},e.reject=(...e)=>{t.isRejected||t.isFulfilled||(t.isRejected=!0,o(...e))}}));return t.catch(x).finally((()=>{t.notify=t.notifyAll=t.lastNotify=null,t.listeners.length=0,t.cancel&&(t.cancel=x)})),Object.assign(t,e),t}();const c=a.then((e=>e.bytes));return this.saveChunkToCache(c,e,t),!n&&this.preloadChunks(e,e+15*this.limitPart),c},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,a)}c((s=s.apply(o,r||[])).next())}));var o,r,i,s}requestFilePartFromCache(e,t,n){const o=this.getChunkKey(e,t);return k.getFile(o).then((e=>n?new Uint8Array:function(e){return function(e){return function(e,t){return new Promise((t=>{const n=new FileReader;n.addEventListener("loadend",(e=>{t(e.target.result)})),n.readAsArrayBuffer(e)}))}(e)}(e).then((e=>new Uint8Array(e)))}(e)),(e=>{}))}requestFilePart(e,t,n){return this.requestFilePartFromCache(e,t,n).then((o=>o||this.requestFilePartFromWorker(e,t,n)))}saveChunkToCache(e,t,n){return e.then((e=>{const o=this.getChunkKey(t,n),r=new Response(e,{headers:{"Content-Length":""+e.length,"Content-Type":"application/octet-stream",[N]:""+(Date.now()/1e3|0)}});return k.save(o,r)}))}preloadChunk(e){this.loadedOffsets.has(e)||(this.loadedOffsets.add(e),this.requestFilePart(e,this.limitPart,!0))}preloadChunks(e,t){if(t>this.info.size&&(t=this.info.size),e)for(;e<t;e+=this.limitPart)this.preloadChunk(e);else this.preloadChunk(R(e,this.limitPart))}requestRange(e){this.destroyDebounced();const t=function(e,t,n){return 0===e[0]&&1===e[1]?new Response(new Uint8Array(2).buffer,{status:206,statusText:"Partial Content",headers:{"Accept-Ranges":"bytes","Content-Range":`bytes 0-1/${n||"*"}`,"Content-Length":"2","Content-Type":t||"video/mp4"}}):null}(e,this.info.mimeType,this.info.size);if(t)return t;let[n,o]=e;const r=o&&o<this.limitPart?function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}(o-n+1):this.limitPart,i=R(n,r);return o||(o=Math.min(n+r,this.info.size-1)),this.requestFilePart(i,r).then((e=>{n===i&&o===i+r||(e=e.slice(n-i,o-i+1));const t={"Accept-Ranges":"bytes","Content-Range":`bytes ${n}-${n+e.byteLength-1}/${this.info.size||"*"}`,"Content-Length":`${e.byteLength}`};return this.info.mimeType&&(t["Content-Type"]=this.info.mimeType),new Response(e,{status:206,statusText:"Partial Content",headers:t})}))}getChunkKey(e,t){return this.id+"?offset="+e+"&limit="+t}static get(e){var t;return null!==(t=D.get(this.getId(e)))&&void 0!==t?t:new I(e)}static getId(e){return e.location.id}}const F=524288,L=1048576;function R(e,t=2048){return e-e%t}function W(e,t){const n=Object.keys,o=typeof e;return e&&t&&"object"===o&&o===typeof t?n(e).length===n(t).length&&n(e).every((n=>W(e[n],t[n]))):e===t}class q{constructor(e){!function(e,t){if(t)for(let n in t)void 0!==t[n]&&(e[n]=t[n])}(this,e),n.test&&(this.name+="_test"),this.storageIsAvailable=!0,this.log=S(["IDB",e.name].join("-")),this.log("constructor"),this.openDatabase(!0),q.INSTANCES.push(this)}isAvailable(){return this.storageIsAvailable}openDatabase(e=!1){if(this.openDbPromise&&!e)return this.openDbPromise;const t=(e,t)=>{var n;const o=Array.from(e.indexNames);for(const t of o)e.deleteIndex(t);if(null===(n=t.indexes)||void 0===n?void 0:n.length)for(const n of t.indexes)e.indexNames.contains(n.indexName)||e.createIndex(n.indexName,n.keyPath,n.objectParameters)};try{var n=indexedDB.open(this.name,this.version);if(!n)return Promise.reject()}catch(e){return this.log.error("error opening db",e.message),this.storageIsAvailable=!1,Promise.reject(e)}let o=!1;return setTimeout((()=>{o||n.onerror({type:"IDB_CREATE_TIMEOUT"})}),3e3),this.openDbPromise=new Promise(((e,r)=>{n.onsuccess=t=>{o=!0;const i=n.result;let s=!1;this.log("Opened"),i.onerror=e=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",e),r(e)},i.onclose=e=>{this.log.error("closed:",e),!s&&this.openDatabase()},i.onabort=e=>{this.log.error("abort:",e);const t=e.target;this.openDatabase(s=!0),t.onerror&&t.onerror(e),i.close()},i.onversionchange=e=>{this.log.error("onversionchange, lol?")},e(this.db=i)},n.onerror=e=>{o=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",e),r(e)},n.onupgradeneeded=e=>{o=!0,this.log.warn("performing idb upgrade from",e.oldVersion,"to",e.newVersion);const n=e.target,r=n.result;this.stores.forEach((e=>{if(r.objectStoreNames.contains(e.name)){const o=n.transaction.objectStore(e.name);t(o,e)}else((e,n)=>{const o=e.createObjectStore(n.name);t(o,n)})(r,e)}))}}))}static create(e){var t;return null!==(t=this.INSTANCES.find((t=>t.name===e.name)))&&void 0!==t?t:new q(e)}static closeDatabases(e){this.INSTANCES.forEach((t=>{if(e&&e===t)return;const n=t.db;n&&(n.onclose=()=>{},n.close())}))}}q.INSTANCES=[];class M{constructor(e,t){this.storeName=t,this.log=S(["IDB",e.name,t].join("-")),this.idb=q.create(e)}delete(e,t){return Array.isArray(e)||(e=[].concat(e)),this.getObjectStore("readwrite",(t=>e.map((e=>t.delete(e)))),"",t)}clear(e){return this.getObjectStore("readwrite",(e=>e.clear()),"",e)}save(e,t,n){return Array.isArray(e)||(e=[].concat(e),t=[].concat(t)),this.getObjectStore("readwrite",(n=>e.map(((e,o)=>n.put(t[o],e)))),"",n)}get(e,t){return Array.isArray(e)||(e=[].concat(e)),e.length?this.getObjectStore("readonly",(t=>e.map((e=>t.get(e)))),"",t):Promise.resolve([])}getObjectStore(e,t,n,o=this.storeName){let r;return n&&(r=performance.now(),this.log(n+": start")),this.idb.openDatabase().then((i=>new Promise(((s,a)=>{const c=i.transaction([o],e),l=()=>{clearTimeout(d),a(c.error)},u=()=>{clearTimeout(d),n&&this.log(n+": end",performance.now()-r);const e=p.map((e=>e.result));s(g?e:e[0])};c.onerror=l;const h="readwrite"===e;h&&(c.oncomplete=()=>u());const d=setTimeout((()=>{this.log.error("transaction not finished",c,n)}),1e4),f=t(c.objectStore(o)),g=Array.isArray(f),p=g?f:[].concat(f);if(h)return;const m=p.length;let v=m;const w=()=>{c.error||--v||u()};for(let e=0;e<m;++e){const t=p[e];t.onerror=l,t.onsuccess=w}}))))}getAll(e){return this.getObjectStore("readonly",(e=>e.getAll()),"",e)}}var B=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};const U=self,$=location.protocol+"//"+location.hostname+location.pathname.split("/").slice(0,-1).join("/")+"/",G=new class{constructor(e,t,n){this.defaults=n,this.cache={},this.storage=new M(e,t)}get(e){return B(this,void 0,void 0,(function*(){if(void 0!==this.cache[e])return this.cache[e];let t;try{t=yield this.storage.get(e)}catch(e){}if(void 0!==this.cache[e])return this.cache[e];if(void 0===t){const n=this.defaults[e];t="function"==typeof n?n():n}return this.cache[e]=t}))}set(e,t){var n;return B(this,void 0,void 0,(function*(){if(!W(null!==(n=this.cache[e])&&void 0!==n?n:this.defaults[e],t)){this.cache[e]=t;try{this.storage.save(e,t)}catch(e){}}}))}}({name:"tweb",version:7,stores:[{name:"session"},{name:"stickerSets"},{name:"users"},{name:"chats"},{name:"dialogs"},{name:"messages"}]},"session",{push_mute_until:0,push_lang:{push_message_nopreview:"You have a new message",push_action_mute1d:"Mute for 24H",push_action_settings:"Settings"},push_settings:{}});U.addEventListener("push",(e=>{const t=e.data.json();H("push",t);let n=!1;const o=Promise.all([G.get("push_mute_until"),U.clients.matchAll({type:"window"})]).then((e=>{const[o,r]=e;if(H("matched clients",r),n=r.length>0,n)throw"Supress notification because some instance is alive";const i=Date.now();if(Y()&&o&&i<o)throw`Supress notification because mute for ${Math.ceil((o-i)/6e4)} min`;if(!t.badge)throw"No badge?"}));o.catch((e=>{H(e)}));const r=o.then((()=>Promise.all([G.get("push_settings"),G.get("push_lang")]))).then((e=>function(e,t,n){const o="assets/img/logo_filled_rounded.png";let r,i=e.title||"Telegram",s=e.description||"";e.custom&&(r=e.custom.channel_id?""+-e.custom.channel_id:e.custom.chat_id?""+-e.custom.chat_id:e.custom.from_id||""),e.custom.peerId=""+r;let a="peer"+r;t&&t.nopreview&&(i="Telegram",s=n.push_message_nopreview,a="unknown_peer"),H("show notify",i,s,o,e);const c=[{action:"mute1d",title:n.push_action_mute1d}];return U.registration.showNotification(i,{body:s,icon:o,tag:a,data:e,actions:c}).then((e=>{var t;e&&e.notification&&(t=e.notification,V.has(t)||(V.add(t),t.onclose=J))})).catch((e=>{H.error("Show notification promise",e)}))}(t,e[0],e[1]))),i=r.catch((()=>(H("Closing all notifications on push",n),Y()||n?K():U.registration.showNotification("Telegram",{tag:"unknown_peer"}).then((()=>{if(n)return K();setTimeout((()=>K()),n?0:100)})).catch((e=>{H.error("Show notification error",e)})))));e.waitUntil(i)})),U.addEventListener("notificationclick",(e=>{const t=e.notification;H("On notification click: ",t.tag),t.close();const n=e.action;if("mute1d"===n&&Y())return H("[SW] mute for 1d"),void G.set("push_mute_until",Date.now()+864e5);const o=t.data;if(!o)return;const r=U.clients.matchAll({type:"window"}).then((e=>{o.action=n,z={type:"push_click",payload:o};for(let t=0;t<e.length;t++){const n=e[t];if("focus"in n)return n.focus(),n.postMessage(z),void(z=void 0)}if(U.clients.openWindow)return G.get("push_settings").then((e=>U.clients.openWindow(e.baseUrl||$)))})).catch((e=>{H.error("Clients.matchAll error",e)}));e.waitUntil(r)})),U.addEventListener("notificationclose",J);let z,V=new Set;function J(e){var t;t=e.notification,V.delete(t)}function K(){for(const e of V)try{e.close()}catch(e){}let e;return e="getNotifications"in U.registration?U.registration.getNotifications({}).then((e=>{for(let t=0,n=e.length;t<n;++t)try{e[t].close()}catch(e){}})).catch((e=>{H.error("Offline register SW error",e)})):Promise.resolve(),V.clear(),e}function Y(){return c}const H=S("SW",m.Error|m.Debug|m.Log|m.Warn),X=self,Q=new Map,Z={notifications_clear:()=>{K()},ping:(e,t)=>{!function(e,t){const n=t.ports&&t.ports[0]||t.source,o=e.payload;z&&n&&"postMessage"in n&&(n.postMessage(z,[]),z=void 0),o.lang&&G.set("push_lang",o.lang),o.settings&&G.set("push_settings",o.settings)}(e,t)},requestFilePart:(e,t)=>{const n=t.source,o=Q.get(n.id);if(!o)return;const r=o[e.id];r&&(e.error?r.reject(e.error):r.resolve(e.payload),delete o[e.id])},toggleStorages:e=>{const{enabled:t,clearWrite:n}=e.payload;j.toggleStorage(t,n)}};X.addEventListener("message",(e=>{const t=e.data,n=Z[t.type];n&&n(t,e)}));const ee=e=>{if(!a&&0===e.request.url.indexOf(location.origin+"/")&&e.request.url.match(/\.(js|css|jpe?g|json|wasm|png|mp3|svg|tgs|ico|woff2?|ttf|webmanifest?)(?:\?.*)?$/))return e.respondWith(function(e){return t=this,n=void 0,r=function*(){try{const t=yield E(A.caches.open(O)),n=yield E(t.match(e.request,{ignoreVary:!0}));if(n&&T(n))return n;const o={Vary:"*"};let r=yield fetch(e.request,{headers:o});if(T(r))t.put(e.request,r.clone());else if(304===r.status){const n=e.request.url.replace(/\?.+$/,"")+"?"+(1e5*Math.random()|0);r=yield fetch(n,{headers:o}),T(r)&&t.put(e.request,r.clone())}return r}catch(t){return fetch(e.request)}},new((o=void 0)||(o=Promise))((function(e,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}c((r=r.apply(t,n||[])).next())}));var t,n,o,r}(e));try{const[,t,n,o]=/http[:s]+\/\/.*?(\/(.*?)(?:$|\/(.*)$))/.exec(e.request.url)||[];"stream"===n&&function(e,t){const n=function(e){if(!e)return[0,0];const[,t]=e.split("="),n=t.split(", "),[o,r]=n[0].split("-");return[+o,+r||0]}(e.request.headers.get("Range")),o=JSON.parse(decodeURIComponent(t)),r=I.get(o);e.respondWith(Promise.race([(45e3,new Promise((e=>{setTimeout((()=>{e(new Response("",{status:408,statusText:"Request timed out."}))}),45e3)}))),r.requestRange(n)]))}(e,o)}catch(t){e.respondWith(new Response("",{status:500,statusText:"Internal Server Error"}))}},te=()=>{X.onfetch=ee};X.addEventListener("install",(e=>{H("installing"),e.waitUntil(X.skipWaiting())})),X.addEventListener("activate",(e=>{H("activating",X),e.waitUntil(X.caches.delete(O)),e.waitUntil(X.clients.claim())})),X.onerror=e=>{H.error("error:",e)},X.onunhandledrejection=e=>{H.error("onunhandledrejection:",e)},X.onoffline=X.ononline=te,te()})();
//# sourceMappingURL=sw.7919a869d2d876da8960.chunk.js.map