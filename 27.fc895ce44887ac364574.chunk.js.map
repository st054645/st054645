{"version":3,"file":"27.fc895ce44887ac364574.chunk.js","mappings":"6IAgBe,MAAMA,EAWnBC,YAAsBC,EAjBD,GAiBC,KAAAA,cAAAA,EAVf,KAAAC,QAAU,EACP,KAAAC,MAAoC,GACpC,KAAAC,UAAsC,IAAIC,IAE1C,KAAAC,YAA6B,KAC7B,KAAAC,cAA4B,KAE5B,KAAAC,KAAM,QAAO,KAAM,YAI3BC,KAAKC,cAAe,QAAS,IAAMD,KAAKE,iBAAiB,IAAI,GAGxDC,QACLH,KAAKL,UAAUQ,QAEfH,KAAKN,MAAMU,OAAS,EAOfC,OACFL,KAAKH,cAGRG,KAAKH,YAAc,IAAIS,SAAQ,CAACC,EAASC,KACvCR,KAAKF,cAAgBS,MAUlBE,SACDT,KAAKF,gBAETE,KAAKF,gBACLE,KAAKF,cAAgBE,KAAKH,YAAc,KAExCG,KAAKC,gBAGSS,YAAYC,G,qCAC1B,IAAGX,KAAKH,YAAR,CAIAG,KAAKL,UAAUiB,IAAID,GAMnB,UAIQX,KAAKa,SAASF,GACpB,MAAMG,GACF,CAAC,iBAAkB,mBAAmBC,SAASD,IACjDd,KAAKD,IAAIiB,MAAM,wBAAyBF,GAI5Cd,KAAKL,UAAUsB,OAAON,GAMtBX,KAAKC,iB,+RAGGY,SAASF,GACjB,OAAOA,EAAKO,OAGJC,UACR,OAAOnB,KAAKN,MAAM0B,QAGVC,WAAWC,EAA4BC,GAC/CvB,KAAKN,MAAM4B,GAAQC,GACnBvB,KAAKC,eAGGC,cAAcS,GACtB,MAAIX,KAAKN,MAAMU,QAAUJ,KAAKH,aAAgBG,KAAKR,cAAgB,GAAKQ,KAAKL,UAAU6B,MAAQxB,KAAKR,eAIpG,EAAG,CAOD,GANGmB,GACD,OAAiBX,KAAKN,MAAOiB,GAE7BA,EAAOX,KAAKmB,WAGXR,EAGD,MAFAX,KAAKU,YAAYC,GAKnBA,EAAO,WAEDX,KAAKL,UAAU6B,KAAOxB,KAAKR,eAAiBQ,KAAKN,MAAMU,QAI1DqB,KAAKF,GACVvB,KAAKqB,WAAW,OAAQE,GAGnBG,QAAQH,GACbvB,KAAKqB,WAAW,UAAWE,M,gCC9H/B,MAEA,EAF2C,CAAC,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAK,EAAK,MAAM,EAAK,MAAM,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,KAAK,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,IAAI,EAAK,KAAM,EAAK,IAAK,EAAK,KAAM,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,KAAM,EAAK,MAAO,EAAK,IAAK,EAAK,IAAK,EAAK,GAAI,EAAK,KAAM,EAAK,IAAK,EAAK,KAAM,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,IAAK,EAAK,KAAM,EAAK,MAAO,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","sources":["webpack://tweb/./src/components/lazyLoadQueueBase.ts","webpack://tweb/./src/config/latinizeMap.ts","webpack://tweb/./src/helpers/array/filterUnique.ts","webpack://tweb/./src/helpers/array/insertInDescendSortedArray.ts","webpack://tweb/./src/helpers/assumeType.ts","webpack://tweb/./src/helpers/bytes/bytesCmp.ts","webpack://tweb/./src/helpers/bytes/bytesFromHex.ts","webpack://tweb/./src/helpers/bytes/convertToUint8Array.ts","webpack://tweb/./src/helpers/callbackify.ts","webpack://tweb/./src/helpers/middleware.ts","webpack://tweb/./src/helpers/object/getObjectKeysAndSort.ts","webpack://tweb/./src/helpers/schedulers/debounce.ts","webpack://tweb/./src/helpers/slicedArray.ts","webpack://tweb/./src/helpers/compareValue.ts","webpack://tweb/./src/helpers/long/compareLong.ts","webpack://tweb/./src/lib/appManagers/utils/chats/getParticipantPeerId.ts","webpack://tweb/./src/lib/appManagers/utils/chats/hasRights.ts","webpack://tweb/./src/lib/appManagers/utils/dialogs/getDialogIndex.ts","webpack://tweb/./src/lib/appManagers/utils/dialogs/getDialogIndexKey.ts","webpack://tweb/./src/lib/appManagers/utils/inlineBots/generateQId.ts","webpack://tweb/./src/lib/appManagers/utils/messages/filterMessagesByInputFilter.ts","webpack://tweb/./src/lib/appManagers/utils/messages/getAlbumText.ts","webpack://tweb/./src/lib/appManagers/utils/peers/getPeerId.ts","webpack://tweb/./src/lib/appManagers/utils/users/canSendToUser.ts","webpack://tweb/./src/lib/mtproto/connectionStatus.ts","webpack://tweb/./src/lib/richTextProcessor/fixEmoji.ts","webpack://tweb/./src/lib/richTextProcessor/matchUrl.ts","webpack://tweb/./src/lib/richTextProcessor/parseMarkdown.ts","webpack://tweb/./src/lib/richTextProcessor/wrapPlainText.ts","webpack://tweb/./src/lib/searchIndex.ts","webpack://tweb/./src/helpers/array/flatten.ts"],"sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport indexOfAndSplice from \"../helpers/array/indexOfAndSplice\";\r\nimport throttle from \"../helpers/schedulers/throttle\";\r\nimport { logger, LogTypes } from \"../lib/logger\";\r\n\r\nconst PARALLEL_LIMIT = 8;\r\n\r\nexport type LazyLoadElementBase = {\r\n  load: () => Promise<any>\r\n};\r\n\r\nexport default class LazyLoadQueueBase {\r\n  public queueId = 0;\r\n  protected queue: Array<LazyLoadElementBase> = [];\r\n  protected inProcess: Set<LazyLoadElementBase> = new Set();\r\n\r\n  protected lockPromise: Promise<void> = null;\r\n  protected unlockResolve: () => void = null;\r\n\r\n  protected log = logger('LL', LogTypes.Error);\r\n  protected processQueue: () => void;\r\n\r\n  constructor(protected parallelLimit = PARALLEL_LIMIT) {\r\n    this.processQueue = throttle(() => this._processQueue(), 20, false);\r\n  }\r\n\r\n  public clear() {\r\n    this.inProcess.clear(); // ацтеки забьются, будет плохо\r\n\r\n    this.queue.length = 0;\r\n    // unreachable code\r\n    /* for(let item of this.inProcess) { \r\n      this.lazyLoadMedia.push(item);\r\n    } */\r\n  }\r\n\r\n  public lock() {\r\n    if(this.lockPromise) return;\r\n\r\n    //const perf = performance.now();\r\n    this.lockPromise = new Promise((resolve, reject) => {\r\n      this.unlockResolve = resolve;\r\n    });\r\n\r\n    /* if(DEBUG) {\r\n      this.lockPromise.then(() => {\r\n        this.log('was locked for:', performance.now() - perf);\r\n      });\r\n    } */\r\n  }\r\n\r\n  public unlock() {\r\n    if(!this.unlockResolve) return;\r\n\r\n    this.unlockResolve();\r\n    this.unlockResolve = this.lockPromise = null;\r\n\r\n    this.processQueue();\r\n  }\r\n\r\n  protected async processItem(item: LazyLoadElementBase) {\r\n    if(this.lockPromise) {\r\n      return;\r\n    }\r\n\r\n    this.inProcess.add(item);\r\n\r\n    /* if(DEBUG) {\r\n      this.log('will load media', this.lockPromise, item);\r\n    } */\r\n\r\n    try {\r\n      //await new Promise((resolve) => setTimeout(resolve, 2e3));\r\n      //await new Promise((resolve, reject) => window.requestAnimationFrame(() => window.requestAnimationFrame(resolve)));\r\n      //await item.load(item.div);\r\n      await this.loadItem(item);\r\n    } catch(err) {\r\n      if(!['NO_ENTRY_FOUND', 'STORAGE_OFFLINE'].includes(err as string)) {\r\n        this.log.error('loadMediaQueue error:', err/* , item */);\r\n      }\r\n    }\r\n\r\n    this.inProcess.delete(item);\r\n\r\n    /* if(DEBUG) {\r\n      this.log('loaded media', item);\r\n    } */\r\n\r\n    this.processQueue();\r\n  }\r\n\r\n  protected loadItem(item: LazyLoadElementBase) {\r\n    return item.load();\r\n  }\r\n\r\n  protected getItem() {\r\n    return this.queue.shift();\r\n  }\r\n\r\n  protected addElement(method: 'push' | 'unshift', el: LazyLoadElementBase) {\r\n    this.queue[method](el);\r\n    this.processQueue();\r\n  }\r\n\r\n  protected _processQueue(item?: LazyLoadElementBase) {\r\n    if(!this.queue.length || this.lockPromise || (this.parallelLimit > 0 && this.inProcess.size >= this.parallelLimit)) return;\r\n\r\n    //console.log('_processQueue start');\r\n    let added = 0;\r\n    do {\r\n      if(item) {\r\n        indexOfAndSplice(this.queue, item);\r\n      } else {\r\n        item = this.getItem();\r\n      }\r\n  \r\n      if(item) {\r\n        this.processItem(item);\r\n      } else {\r\n        break;\r\n      }\r\n\r\n      item = null;\r\n      ++added;\r\n    } while(this.inProcess.size < this.parallelLimit && this.queue.length);\r\n    //console.log('_processQueue end, added', added, this.queue.length);\r\n  }\r\n\r\n  public push(el: LazyLoadElementBase) {\r\n    this.addElement('push', el);\r\n  }\r\n\r\n  public unshift(el: LazyLoadElementBase) {\r\n    this.addElement('unshift', el);\r\n  }\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n * \r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\n// From https://raw.githubusercontent.com/FGRibreau/latenize/master/latinize_map.js\r\nconst LatinizeMap: {[k: string]: string} = {'Á': 'A','Ă': 'A','Ắ': 'A','Ặ': 'A','Ằ': 'A','Ẳ': 'A','Ẵ': 'A','Ǎ': 'A','Â': 'A','Ấ': 'A','Ậ': 'A','Ầ': 'A','Ẩ': 'A','Ẫ': 'A','Ä': 'A','Ǟ': 'A','Ȧ': 'A','Ǡ': 'A','Ạ': 'A','Ȁ': 'A','À': 'A','Ả': 'A','Ȃ': 'A','Ā': 'A','Ą': 'A','Å': 'A','Ǻ': 'A','Ḁ': 'A','Ⱥ': 'A','Ã': 'A','Ꜳ': 'AA','Æ': 'AE','Ǽ': 'AE','Ǣ': 'AE','Ꜵ': 'AO','Ꜷ': 'AU','Ꜹ': 'AV','Ꜻ': 'AV','Ꜽ': 'AY','Ḃ': 'B','Ḅ': 'B','Ɓ': 'B','Ḇ': 'B','Ƀ': 'B','Ƃ': 'B','Ć': 'C','Č': 'C','Ç': 'C','Ḉ': 'C','Ĉ': 'C','Ċ': 'C','Ƈ': 'C','Ȼ': 'C','Ď': 'D','Ḑ': 'D','Ḓ': 'D','Ḋ': 'D','Ḍ': 'D','Ɗ': 'D','Ḏ': 'D','ǲ': 'D','ǅ': 'D','Đ': 'D','Ƌ': 'D','Ǳ': 'DZ','Ǆ': 'DZ','É': 'E','Ĕ': 'E','Ě': 'E','Ȩ': 'E','Ḝ': 'E','Ê': 'E','Ế': 'E','Ệ': 'E','Ề': 'E','Ể': 'E','Ễ': 'E','Ḙ': 'E','Ë': 'E','Ė': 'E','Ẹ': 'E','Ȅ': 'E','È': 'E','Ẻ': 'E','Ȇ': 'E','Ē': 'E','Ḗ': 'E','Ḕ': 'E','Ę': 'E','Ɇ': 'E','Ẽ': 'E','Ḛ': 'E','Ꝫ': 'ET','Ḟ': 'F','Ƒ': 'F','Ǵ': 'G','Ğ': 'G','Ǧ': 'G','Ģ': 'G','Ĝ': 'G','Ġ': 'G','Ɠ': 'G','Ḡ': 'G','Ǥ': 'G','Ḫ': 'H','Ȟ': 'H','Ḩ': 'H','Ĥ': 'H','Ⱨ': 'H','Ḧ': 'H','Ḣ': 'H','Ḥ': 'H','Ħ': 'H','Í': 'I','Ĭ': 'I','Ǐ': 'I','Î': 'I','Ï': 'I','Ḯ': 'I','İ': 'I','Ị': 'I','Ȉ': 'I','Ì': 'I','Ỉ': 'I','Ȋ': 'I','Ī': 'I','Į': 'I','Ɨ': 'I','Ĩ': 'I','Ḭ': 'I','Ꝺ': 'D','Ꝼ': 'F','Ᵹ': 'G','Ꞃ': 'R','Ꞅ': 'S','Ꞇ': 'T','Ꝭ': 'IS','Ĵ': 'J','Ɉ': 'J','Ḱ': 'K','Ǩ': 'K','Ķ': 'K','Ⱪ': 'K','Ꝃ': 'K','Ḳ': 'K','Ƙ': 'K','Ḵ': 'K','Ꝁ': 'K','Ꝅ': 'K','Ĺ': 'L','Ƚ': 'L','Ľ': 'L','Ļ': 'L','Ḽ': 'L','Ḷ': 'L','Ḹ': 'L','Ⱡ': 'L','Ꝉ': 'L','Ḻ': 'L','Ŀ': 'L','Ɫ': 'L','ǈ': 'L','Ł': 'L','Ǉ': 'LJ','Ḿ': 'M','Ṁ': 'M','Ṃ': 'M','Ɱ': 'M','Ń': 'N','Ň': 'N','Ņ': 'N','Ṋ': 'N','Ṅ': 'N','Ṇ': 'N','Ǹ': 'N','Ɲ': 'N','Ṉ': 'N','Ƞ': 'N','ǋ': 'N','Ñ': 'N','Ǌ': 'NJ','Ó': 'O','Ŏ': 'O','Ǒ': 'O','Ô': 'O','Ố': 'O','Ộ': 'O','Ồ': 'O','Ổ': 'O','Ỗ': 'O','Ö': 'O','Ȫ': 'O','Ȯ': 'O','Ȱ': 'O','Ọ': 'O','Ő': 'O','Ȍ': 'O','Ò': 'O','Ỏ': 'O','Ơ': 'O','Ớ': 'O','Ợ': 'O','Ờ': 'O','Ở': 'O','Ỡ': 'O','Ȏ': 'O','Ꝋ': 'O','Ꝍ': 'O','Ō': 'O','Ṓ': 'O','Ṑ': 'O','Ɵ': 'O','Ǫ': 'O','Ǭ': 'O','Ø': 'O','Ǿ': 'O','Õ': 'O','Ṍ': 'O','Ṏ': 'O','Ȭ': 'O','Ƣ': 'OI','Ꝏ': 'OO','Ɛ': 'E','Ɔ': 'O','Ȣ': 'OU','Ṕ': 'P','Ṗ': 'P','Ꝓ': 'P','Ƥ': 'P','Ꝕ': 'P','Ᵽ': 'P','Ꝑ': 'P','Ꝙ': 'Q','Ꝗ': 'Q','Ŕ': 'R','Ř': 'R','Ŗ': 'R','Ṙ': 'R','Ṛ': 'R','Ṝ': 'R','Ȑ': 'R','Ȓ': 'R','Ṟ': 'R','Ɍ': 'R','Ɽ': 'R','Ꜿ': 'C','Ǝ': 'E','Ś': 'S','Ṥ': 'S','Š': 'S','Ṧ': 'S','Ş': 'S','Ŝ': 'S','Ș': 'S','Ṡ': 'S','Ṣ': 'S','Ṩ': 'S','ẞ': 'SS','Ť': 'T','Ţ': 'T','Ṱ': 'T','Ț': 'T','Ⱦ': 'T','Ṫ': 'T','Ṭ': 'T','Ƭ': 'T','Ṯ': 'T','Ʈ': 'T','Ŧ': 'T','Ɐ': 'A','Ꞁ': 'L','Ɯ': 'M','Ʌ': 'V','Ꜩ': 'TZ','Ú': 'U','Ŭ': 'U','Ǔ': 'U','Û': 'U','Ṷ': 'U','Ü': 'U','Ǘ': 'U','Ǚ': 'U','Ǜ': 'U','Ǖ': 'U','Ṳ': 'U','Ụ': 'U','Ű': 'U','Ȕ': 'U','Ù': 'U','Ủ': 'U','Ư': 'U','Ứ': 'U','Ự': 'U','Ừ': 'U','Ử': 'U','Ữ': 'U','Ȗ': 'U','Ū': 'U','Ṻ': 'U','Ų': 'U','Ů': 'U','Ũ': 'U','Ṹ': 'U','Ṵ': 'U','Ꝟ': 'V','Ṿ': 'V','Ʋ': 'V','Ṽ': 'V','Ꝡ': 'VY','Ẃ': 'W','Ŵ': 'W','Ẅ': 'W','Ẇ': 'W','Ẉ': 'W','Ẁ': 'W','Ⱳ': 'W','Ẍ': 'X','Ẋ': 'X','Ý': 'Y','Ŷ': 'Y','Ÿ': 'Y','Ẏ': 'Y','Ỵ': 'Y','Ỳ': 'Y','Ƴ': 'Y','Ỷ': 'Y','Ỿ': 'Y','Ȳ': 'Y','Ɏ': 'Y','Ỹ': 'Y','Ź': 'Z','Ž': 'Z','Ẑ': 'Z','Ⱬ': 'Z','Ż': 'Z','Ẓ': 'Z','Ȥ': 'Z','Ẕ': 'Z','Ƶ': 'Z','Ĳ': 'IJ','Œ': 'OE','ᴀ': 'A','ᴁ': 'AE','ʙ': 'B','ᴃ': 'B','ᴄ': 'C','ᴅ': 'D','ᴇ': 'E','ꜰ': 'F','ɢ': 'G','ʛ': 'G','ʜ': 'H','ɪ': 'I','ʁ': 'R','ᴊ': 'J','ᴋ': 'K','ʟ': 'L','ᴌ': 'L','ᴍ': 'M','ɴ': 'N','ᴏ': 'O','ɶ': 'OE','ᴐ': 'O','ᴕ': 'OU','ᴘ': 'P','ʀ': 'R','ᴎ': 'N','ᴙ': 'R','ꜱ': 'S','ᴛ': 'T','ⱻ': 'E','ᴚ': 'R','ᴜ': 'U','ᴠ': 'V','ᴡ': 'W','ʏ': 'Y','ᴢ': 'Z','á': 'a','ă': 'a','ắ': 'a','ặ': 'a','ằ': 'a','ẳ': 'a','ẵ': 'a','ǎ': 'a','â': 'a','ấ': 'a','ậ': 'a','ầ': 'a','ẩ': 'a','ẫ': 'a','ä': 'a','ǟ': 'a','ȧ': 'a','ǡ': 'a','ạ': 'a','ȁ': 'a','à': 'a','ả': 'a','ȃ': 'a','ā': 'a','ą': 'a','ᶏ': 'a','ẚ': 'a','å': 'a','ǻ': 'a','ḁ': 'a','ⱥ': 'a','ã': 'a','ꜳ': 'aa','æ': 'ae','ǽ': 'ae','ǣ': 'ae','ꜵ': 'ao','ꜷ': 'au','ꜹ': 'av','ꜻ': 'av','ꜽ': 'ay','ḃ': 'b','ḅ': 'b','ɓ': 'b','ḇ': 'b','ᵬ': 'b','ᶀ': 'b','ƀ': 'b','ƃ': 'b','ɵ': 'o','ć': 'c','č': 'c','ç': 'c','ḉ': 'c','ĉ': 'c','ɕ': 'c','ċ': 'c','ƈ': 'c','ȼ': 'c','ď': 'd','ḑ': 'd','ḓ': 'd','ȡ': 'd','ḋ': 'd','ḍ': 'd','ɗ': 'd','ᶑ': 'd','ḏ': 'd','ᵭ': 'd','ᶁ': 'd','đ': 'd','ɖ': 'd','ƌ': 'd','ı': 'i','ȷ': 'j','ɟ': 'j','ʄ': 'j','ǳ': 'dz','ǆ': 'dz','é': 'e','ĕ': 'e','ě': 'e','ȩ': 'e','ḝ': 'e','ê': 'e','ế': 'e','ệ': 'e','ề': 'e','ể': 'e','ễ': 'e','ḙ': 'e','ë': 'e','ė': 'e','ẹ': 'e','ȅ': 'e','è': 'e','ẻ': 'e','ȇ': 'e','ē': 'e','ḗ': 'e','ḕ': 'e','ⱸ': 'e','ę': 'e','ᶒ': 'e','ɇ': 'e','ẽ': 'e','ḛ': 'e','ꝫ': 'et','ḟ': 'f','ƒ': 'f','ᵮ': 'f','ᶂ': 'f','ǵ': 'g','ğ': 'g','ǧ': 'g','ģ': 'g','ĝ': 'g','ġ': 'g','ɠ': 'g','ḡ': 'g','ᶃ': 'g','ǥ': 'g','ḫ': 'h','ȟ': 'h','ḩ': 'h','ĥ': 'h','ⱨ': 'h','ḧ': 'h','ḣ': 'h','ḥ': 'h','ɦ': 'h','ẖ': 'h','ħ': 'h','ƕ': 'hv','í': 'i','ĭ': 'i','ǐ': 'i','î': 'i','ï': 'i','ḯ': 'i','ị': 'i','ȉ': 'i','ì': 'i','ỉ': 'i','ȋ': 'i','ī': 'i','į': 'i','ᶖ': 'i','ɨ': 'i','ĩ': 'i','ḭ': 'i','ꝺ': 'd','ꝼ': 'f','ᵹ': 'g','ꞃ': 'r','ꞅ': 's','ꞇ': 't','ꝭ': 'is','ǰ': 'j','ĵ': 'j','ʝ': 'j','ɉ': 'j','ḱ': 'k','ǩ': 'k','ķ': 'k','ⱪ': 'k','ꝃ': 'k','ḳ': 'k','ƙ': 'k','ḵ': 'k','ᶄ': 'k','ꝁ': 'k','ꝅ': 'k','ĺ': 'l','ƚ': 'l','ɬ': 'l','ľ': 'l','ļ': 'l','ḽ': 'l','ȴ': 'l','ḷ': 'l','ḹ': 'l','ⱡ': 'l','ꝉ': 'l','ḻ': 'l','ŀ': 'l','ɫ': 'l','ᶅ': 'l','ɭ': 'l','ł': 'l','ǉ': 'lj','ſ': 's','ẜ': 's','ẛ': 's','ẝ': 's','ḿ': 'm','ṁ': 'm','ṃ': 'm','ɱ': 'm','ᵯ': 'm','ᶆ': 'm','ń': 'n','ň': 'n','ņ': 'n','ṋ': 'n','ȵ': 'n','ṅ': 'n','ṇ': 'n','ǹ': 'n','ɲ': 'n','ṉ': 'n','ƞ': 'n','ᵰ': 'n','ᶇ': 'n','ɳ': 'n','ñ': 'n','ǌ': 'nj','ó': 'o','ŏ': 'o','ǒ': 'o','ô': 'o','ố': 'o','ộ': 'o','ồ': 'o','ổ': 'o','ỗ': 'o','ö': 'o','ȫ': 'o','ȯ': 'o','ȱ': 'o','ọ': 'o','ő': 'o','ȍ': 'o','ò': 'o','ỏ': 'o','ơ': 'o','ớ': 'o','ợ': 'o','ờ': 'o','ở': 'o','ỡ': 'o','ȏ': 'o','ꝋ': 'o','ꝍ': 'o','ⱺ': 'o','ō': 'o','ṓ': 'o','ṑ': 'o','ǫ': 'o','ǭ': 'o','ø': 'o','ǿ': 'o','õ': 'o','ṍ': 'o','ṏ': 'o','ȭ': 'o','ƣ': 'oi','ꝏ': 'oo','ɛ': 'e','ᶓ': 'e','ɔ': 'o','ᶗ': 'o','ȣ': 'ou','ṕ': 'p','ṗ': 'p','ꝓ': 'p','ƥ': 'p','ᵱ': 'p','ᶈ': 'p','ꝕ': 'p','ᵽ': 'p','ꝑ': 'p','ꝙ': 'q','ʠ': 'q','ɋ': 'q','ꝗ': 'q','ŕ': 'r','ř': 'r','ŗ': 'r','ṙ': 'r','ṛ': 'r','ṝ': 'r','ȑ': 'r','ɾ': 'r','ᵳ': 'r','ȓ': 'r','ṟ': 'r','ɼ': 'r','ᵲ': 'r','ᶉ': 'r','ɍ': 'r','ɽ': 'r','ↄ': 'c','ꜿ': 'c','ɘ': 'e','ɿ': 'r','ś': 's','ṥ': 's','š': 's','ṧ': 's','ş': 's','ŝ': 's','ș': 's','ṡ': 's','ṣ': 's','ṩ': 's','ʂ': 's','ᵴ': 's','ᶊ': 's','ȿ': 's','ɡ': 'g','ß': 'ss','ᴑ': 'o','ᴓ': 'o','ᴝ': 'u','ť': 't','ţ': 't','ṱ': 't','ț': 't','ȶ': 't','ẗ': 't','ⱦ': 't','ṫ': 't','ṭ': 't','ƭ': 't','ṯ': 't','ᵵ': 't','ƫ': 't','ʈ': 't','ŧ': 't','ᵺ': 'th','ɐ': 'a','ᴂ': 'ae','ǝ': 'e','ᵷ': 'g','ɥ': 'h','ʮ': 'h','ʯ': 'h','ᴉ': 'i','ʞ': 'k','ꞁ': 'l','ɯ': 'm','ɰ': 'm','ᴔ': 'oe','ɹ': 'r','ɻ': 'r','ɺ': 'r','ⱹ': 'r','ʇ': 't','ʌ': 'v','ʍ': 'w','ʎ': 'y','ꜩ': 'tz','ú': 'u','ŭ': 'u','ǔ': 'u','û': 'u','ṷ': 'u','ü': 'u','ǘ': 'u','ǚ': 'u','ǜ': 'u','ǖ': 'u','ṳ': 'u','ụ': 'u','ű': 'u','ȕ': 'u','ù': 'u','ủ': 'u','ư': 'u','ứ': 'u','ự': 'u','ừ': 'u','ử': 'u','ữ': 'u','ȗ': 'u','ū': 'u','ṻ': 'u','ų': 'u','ᶙ': 'u','ů': 'u','ũ': 'u','ṹ': 'u','ṵ': 'u','ᵫ': 'ue','ꝸ': 'um','ⱴ': 'v','ꝟ': 'v','ṿ': 'v','ʋ': 'v','ᶌ': 'v','ⱱ': 'v','ṽ': 'v','ꝡ': 'vy','ẃ': 'w','ŵ': 'w','ẅ': 'w','ẇ': 'w','ẉ': 'w','ẁ': 'w','ⱳ': 'w','ẘ': 'w','ẍ': 'x','ẋ': 'x','ᶍ': 'x','ý': 'y','ŷ': 'y','ÿ': 'y','ẏ': 'y','ỵ': 'y','ỳ': 'y','ƴ': 'y','ỷ': 'y','ỿ': 'y','ȳ': 'y','ẙ': 'y','ɏ': 'y','ỹ': 'y','ź': 'z','ž': 'z','ẑ': 'z','ʑ': 'z','ⱬ': 'z','ż': 'z','ẓ': 'z','ȥ': 'z','ẕ': 'z','ᵶ': 'z','ᶎ': 'z','ʐ': 'z','ƶ': 'z','ɀ': 'z','ﬀ': 'ff','ﬃ': 'ffi','ﬄ': 'ffl','ﬁ': 'fi','ﬂ': 'fl','ĳ': 'ij','œ': 'oe','ﬆ': 'st','ₐ': 'a','ₑ': 'e','ᵢ': 'i','ⱼ': 'j','ₒ': 'o','ᵣ': 'r','ᵤ': 'u','ᵥ': 'v','ₓ': 'x','Ё': 'YO', 'Й': 'I', 'Ц': 'TS', 'У': 'U', 'К': 'K', 'Е': 'E', 'Н': 'N', 'Г': 'G', 'Ш': 'SH', 'Щ': 'SCH', 'З': 'Z', 'Х': 'H', 'Ъ': '', 'ё': 'yo', 'й': 'i', 'ц': 'ts', 'у': 'u', 'к': 'k', 'е': 'e', 'н': 'n', 'г': 'g', 'ш': 'sh', 'щ': 'sch', 'з': 'z', 'х': 'h', 'ъ': '', 'Ф': 'F', 'Ы': 'I', 'В': 'V', 'А': 'A', 'П': 'P', 'Р': 'R', 'О': 'O', 'Л': 'L', 'Д': 'D', 'Ж': 'ZH', 'Э': 'E', 'ф': 'f', 'ы': 'i', 'в': 'v', 'а': 'a', 'п': 'p', 'р': 'r', 'о': 'o', 'л': 'l', 'д': 'd', 'ж': 'zh', 'э': 'e', 'Я': 'Ya', 'Ч': 'CH', 'С': 'S', 'М': 'M', 'И': 'I', 'Т': 'T', 'Ь': '', 'Б': 'B', 'Ю': 'YU', 'я': 'ya', 'ч': 'ch', 'с': 's', 'м': 'm', 'и': 'i', 'т': 't', 'ь': '', 'б': 'b', 'ю': 'yu'};\r\n\r\nexport default LatinizeMap;\r\n","export default function filterUnique<T extends Array<any>>(arr: T): T {\r\n  return [...new Set(arr)] as T;\r\n}\r\n","export default function insertInDescendSortedArray<T extends {[smth in K]?: number}, K extends keyof T>(array: Array<T>, element: T, getProperty: K, pos?: number): number;\r\nexport default function insertInDescendSortedArray<T>(array: Array<T>, element: T, getProperty: (element: T) => number, pos?: number): number;\r\nexport default function insertInDescendSortedArray<T extends {[smth in K]?: number}, K extends keyof T>(array: Array<T>, element: T, getProperty: K | ((element: T) => T[K]), pos?: number): number {\r\n  if(typeof(getProperty) !== 'function') {\r\n    const property = getProperty;\r\n    getProperty = (element) => element[property];\r\n  }\r\n\r\n  const sortProperty: number = getProperty(element);\r\n\r\n  if(pos === undefined) {\r\n    pos = array.indexOf(element);\r\n    if(pos !== -1) {\r\n      const prev = array[pos - 1];\r\n      const next = array[pos + 1];\r\n      if((!prev || getProperty(prev) >= sortProperty) && (!next || getProperty(next) <= sortProperty)) {\r\n        // console.warn('same pos', pos, sortProperty, prev, next);\r\n        return pos;\r\n      }\r\n      \r\n      array.splice(pos, 1);\r\n    }\r\n  }\r\n\r\n  const len = array.length;\r\n  if(!len || sortProperty <= getProperty(array[len - 1])) {\r\n    return array.push(element) - 1;\r\n  } else if(sortProperty >= getProperty(array[0])) {\r\n    array.unshift(element);\r\n    return 0;\r\n  } else {\r\n    for(let i = 0; i < len; i++) {\r\n      if(sortProperty > getProperty(array[i])) {\r\n        array.splice(i, 0, element);\r\n        return i;\r\n      }\r\n    }\r\n  }\r\n\r\n  console.error('wtf', array, element);\r\n  return array.indexOf(element);\r\n}\r\n","export default function assumeType<T>(x: unknown): asserts x is T {\r\n  return; // ¯\\_(ツ)_/¯\r\n}\r\n","export default function bytesCmp(bytes1: number[] | Uint8Array, bytes2: number[] | Uint8Array) {\r\n  const len = bytes1.length;\r\n  if(len !== bytes2.length) {\r\n    return false;\r\n  }\r\n\r\n  for(let i = 0; i < len; ++i) {\r\n    if(bytes1[i] !== bytes2[i]) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n","export default function bytesFromHex(hexString: string) {\r\n  const len = hexString.length;\r\n  const bytes = new Uint8Array(Math.ceil(len / 2));\r\n  let start = 0;\r\n\r\n  if(len % 2) { // read 0x581 as 0x0581\r\n    bytes[start++] = parseInt(hexString.charAt(0), 16);\r\n  }\r\n\r\n  for(let i = start; i < len; i += 2) {\r\n    bytes[start++] = parseInt(hexString.substr(i, 2), 16);\r\n  }\r\n\r\n  return bytes;\r\n}\r\n","export default function convertToUint8Array(bytes: Uint8Array | ArrayBuffer | number[] | string): Uint8Array {\r\n  if(bytes instanceof Uint8Array) {\r\n    return bytes;\r\n  } else if(typeof(bytes) === 'string') {\r\n    return new TextEncoder().encode(bytes);\r\n  }\r\n\r\n  return new Uint8Array(bytes);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { Awaited } from '../types';\r\n\r\nexport default function callbackify<T extends Awaited<any>, R>(\r\n  smth: T, \r\n  callback: (result: Awaited<T>) => R\r\n): R {\r\n  if(smth instanceof Promise) {\r\n    // @ts-ignore\r\n    return smth.then(callback);\r\n  } else {\r\n    return callback(smth as any);\r\n  }\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\n// * will change .cleaned and new instance will be created\r\nexport const getMiddleware = () => {\r\n  let cleanupObj = {cleaned: false};\r\n  return {\r\n    clean: () => {\r\n      cleanupObj.cleaned = true;\r\n      cleanupObj = {cleaned: false};\r\n    },\r\n    get: (additionalCallback?: () => boolean) => {\r\n      const _cleanupObj = cleanupObj;\r\n      return () => {\r\n        return !_cleanupObj.cleaned && (!additionalCallback || additionalCallback());\r\n      };\r\n    }\r\n  };\r\n};\r\n","export default function getObjectKeysAndSort(object: {[key: string]: any} | Map<number, any>, sort: 'asc' | 'desc' = 'asc') {\r\n  if(!object) return [];\r\n  const ids = object instanceof Map ? [...object.keys()] : Object.keys(object).map((i) => +i);\r\n  if(sort === 'asc') return ids.sort((a, b) => a - b);\r\n  else return ids.sort((a, b) => b - a);\r\n}\r\n","// * Jolly Cobra's schedulers\r\n\r\nimport ctx from \"../../environment/ctx\";\r\nimport { AnyFunction, Awaited } from \"../../types\";\r\nimport noop from \"../noop\";\r\n\r\nexport type DebounceReturnType<F extends AnyFunction> = { \r\n  (...args: Parameters<F>): Promise<Awaited<ReturnType<F>>>; \r\n  clearTimeout(): void; \r\n};\r\n\r\nexport default function debounce<F extends AnyFunction>(\r\n  fn: F,\r\n  ms: number,\r\n  shouldRunFirst = true,\r\n  shouldRunLast = true,\r\n): DebounceReturnType<F> {\r\n  let waitingTimeout: number;\r\n  let waitingPromise: Promise<Awaited<ReturnType<F>>>, resolve: (result: any) => void, reject: () => void;\r\n  let hadNewCall = false;\r\n\r\n  const invoke = (args: Parameters<F>) => {\r\n    const _resolve = resolve, _reject = reject;\r\n    try {\r\n      const result = fn.apply(null, args);\r\n      _resolve(result);\r\n    } catch(err) {\r\n      console.error('debounce error', err);\r\n      // @ts-ignore\r\n      _reject(err);\r\n    }\r\n  };\r\n\r\n  const debounce = (...args: Parameters<F>) => {\r\n    if(!waitingPromise) waitingPromise = new Promise((_resolve, _reject) => (resolve = _resolve, reject = _reject));\r\n\r\n    if(waitingTimeout) {\r\n      clearTimeout(waitingTimeout);\r\n      hadNewCall = true;\r\n      reject();\r\n      waitingPromise = new Promise((_resolve, _reject) => (resolve = _resolve, reject = _reject));\r\n    } else if(shouldRunFirst) {\r\n      invoke(args);\r\n      hadNewCall = false;\r\n    }\r\n\r\n    const _waitingTimeout = ctx.setTimeout(() => {\r\n      // will run if should run last or first but with new call\r\n      if(shouldRunLast && (!shouldRunFirst || hadNewCall)) {\r\n        invoke(args);\r\n      }\r\n      \r\n      // if debounce was called during invoking\r\n      if(waitingTimeout === _waitingTimeout) {\r\n        waitingTimeout = waitingPromise = resolve = reject = undefined;\r\n        hadNewCall = false;\r\n      }\r\n    }, ms);\r\n\r\n    waitingTimeout = _waitingTimeout;\r\n    waitingPromise.catch(noop);\r\n    return waitingPromise;\r\n  };\r\n\r\n  debounce.clearTimeout = () => {\r\n    if(waitingTimeout) {\r\n      ctx.clearTimeout(waitingTimeout);\r\n      reject();\r\n      waitingTimeout = waitingPromise = resolve = reject = undefined;\r\n      hadNewCall = false;\r\n    }\r\n  };\r\n\r\n  return debounce;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { MOUNT_CLASS_TO } from \"../config/debug\";\r\nimport indexOfAndSplice from \"./array/indexOfAndSplice\";\r\nimport compareValue from \"./compareValue\";\r\n\r\n/**\r\n * Descend sorted storage\r\n */\r\n\r\ntype ItemType = number | string;\r\n\r\nexport enum SliceEnd {\r\n  None = 0,\r\n  Top = 1,\r\n  Bottom = 2,\r\n  Both = SliceEnd.Top | SliceEnd.Bottom\r\n};\r\n\r\nexport interface Slice<T extends ItemType> extends Array<T> {\r\n  //slicedArray: SlicedArray;\r\n  end: SliceEnd;\r\n\r\n  isEnd: (side: SliceEnd) => boolean;\r\n  setEnd: (side: SliceEnd) => void;\r\n  unsetEnd: (side: SliceEnd) => void;\r\n  getEnds: () => {top: boolean, bottom: boolean, both: boolean};\r\n\r\n  slice: (from?: number, to?: number) => Slice<T>;\r\n  splice: (start: number, deleteCount: number, ...items: ItemType[]) => Slice<T>;\r\n}\r\n\r\nexport interface SliceConstructor<T extends ItemType> {\r\n  // new(...items: T[]): Slice<T>;\r\n  new(length: number): Slice<T>;\r\n}\r\n\r\nexport type SliceSerialized<T extends ItemType> = {\r\n  values: Slice<T>,\r\n  isEnd: {\r\n    top: boolean,\r\n    bottom: boolean,\r\n    both: boolean\r\n  }\r\n};\r\n\r\nexport type SlicedArraySerialized<T extends ItemType> = {\r\n  slices: SliceSerialized<T>[]\r\n};\r\n\r\nexport default class SlicedArray<T extends ItemType> {\r\n  private slices: Slice<T>[]/*  = [[7,6,5],[4,3,2],[1,0,-1]] */;\r\n  private sliceConstructor: SliceConstructor<T>;\r\n  \r\n  constructor() {\r\n    // @ts-ignore\r\n    this.sliceConstructor = SlicedArray.getSliceConstructor(this);\r\n\r\n    const first = this.constructSlice();\r\n    //first.setEnd(SliceEnd.Bottom);\r\n    this.slices = [first];\r\n  }\r\n\r\n  private static getSliceConstructor(slicedArray: SlicedArray<ItemType>) {\r\n    return class Slice<T> extends Array<ItemType> implements Slice<T> {\r\n      //slicedArray: SlicedArray;\r\n      end: SliceEnd = SliceEnd.None;\r\n  \r\n      /* constructor(...items: ItemType[]) {\r\n        super(...items);\r\n        //this.slicedArray = slicedArray;\r\n      } */\r\n  \r\n      isEnd(side: SliceEnd): boolean {\r\n        if((this.end & side) === side) {\r\n          return true;\r\n        }/*  else if(!this.slicedArray) {\r\n          return false;\r\n        } */\r\n  \r\n        let isEnd = false;\r\n        if(side === SliceEnd.Top) {\r\n          const slice = slicedArray.last;\r\n          isEnd = slice.end & side ? this.includes(slice[slice.length - 1])/*  || !slice.length */ : false;\r\n        } else if(side === SliceEnd.Bottom) {\r\n          const slice = slicedArray.first;\r\n          isEnd = slice.end & side ? this.includes(slice[0])/*  || !slice.length */ : false;\r\n        } else if(side === SliceEnd.Both) {\r\n          return this.isEnd(SliceEnd.Top) && this.isEnd(SliceEnd.Bottom);\r\n        }\r\n\r\n        if(isEnd) {\r\n          this.setEnd(side);\r\n        }\r\n  \r\n        return isEnd;\r\n      }\r\n\r\n      getEnds() {\r\n        return {\r\n          top: this.isEnd(SliceEnd.Top),\r\n          bottom: this.isEnd(SliceEnd.Bottom),\r\n          both: this.isEnd(SliceEnd.Both)\r\n        };\r\n      }\r\n  \r\n      setEnd(side: SliceEnd) {\r\n        this.end |= side;\r\n      }\r\n\r\n      unsetEnd(side: SliceEnd) {\r\n        this.end &= ~side;\r\n      }\r\n\r\n      splice(start: number, deleteCount: number, ...items: ItemType[]) {\r\n        const ret = super.splice(start, deleteCount, ...items);\r\n\r\n        if(!this.length) {\r\n          const slices = slicedArray.slices as ItemType[][];\r\n          const idx = slices.indexOf(this);\r\n          if(idx !== -1) {\r\n            if(slices.length === 1) { // left empty slice without ends\r\n              this.unsetEnd(SliceEnd.Both);\r\n            } else { // delete this slice\r\n              slices.splice(idx, 1);\r\n            }\r\n          }\r\n        }\r\n\r\n        return ret;\r\n      }\r\n    }\r\n  }\r\n\r\n  public constructSlice(...items: T[]) {\r\n    //const slice = new Slice(this, ...items);\r\n    // can't pass items directly to constructor because first argument is length\r\n    const slice = new this.sliceConstructor(items.length);\r\n    for(let i = 0, length = items.length; i < length; ++i) {\r\n      slice[i] = items[i];\r\n    }\r\n    return slice;\r\n    \r\n    // ! code below will slow execution in 15 times\r\n    /* const self = this;\r\n    const p: Slice = new Proxy(slice, {\r\n      get: function(target, name: any) {\r\n        if(name === 'constructor') {\r\n          const p = new Proxy(Slice, {\r\n            construct: (target, args) => {\r\n              return self.constructSlice(...args);\r\n            }\r\n          });\r\n\r\n          return p;\r\n        }\r\n\r\n        return target[name];\r\n      }\r\n    });\r\n\r\n    return p; */\r\n\r\n    /*\r\n    var p = slicedArray.constructSlice();\r\n    p.length = 100000;\r\n    p.fill(255);\r\n\r\n    var a = new Array(100000);\r\n    a.fill(255);\r\n\r\n    var b = 0;\r\n    var perf = performance.now();\r\n    for(var i = 0; i < p.length; ++i) {\r\n        b += p[i];\r\n    }\r\n\r\n    console.log('perf 1', performance.now() - perf);\r\n\r\n    b = 0;\r\n    perf = performance.now();\r\n    for(var i = 0; i < a.length; ++i) {\r\n        b += a[i];\r\n    }\r\n\r\n    console.log('perf 2', performance.now() - perf);\r\n    */\r\n  }\r\n\r\n  public insertSlice(slice: T[], flatten = true) {\r\n    if(!slice.length) {\r\n      return;\r\n    }\r\n\r\n    const first = this.slices[0];\r\n    if(!first.length) {\r\n      first.push(...slice);\r\n      return first;\r\n    }\r\n\r\n    const lowerBound = slice[slice.length - 1];\r\n    const upperBound = slice[0];\r\n\r\n    let foundSlice: Slice<T>, lowerIndex = -1, upperIndex = -1, foundSliceIndex = 0;\r\n    for(; foundSliceIndex < this.slices.length; ++foundSliceIndex) {\r\n      foundSlice = this.slices[foundSliceIndex];\r\n      lowerIndex = foundSlice.indexOf(lowerBound);\r\n      upperIndex = foundSlice.indexOf(upperBound);\r\n      \r\n      if(upperIndex !== -1 && -1 !== lowerIndex) {\r\n        break;\r\n      } else if(upperIndex !== -1 || -1 !== lowerIndex) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    if(upperIndex !== -1 && -1 !== lowerIndex) {\r\n\r\n    } else if(upperIndex !== -1) {  // ([1, 2, 3] | [1, 2, 3, 4, 5]) -> [1, 2, 3, 4, 5]\r\n      const sliced = slice.slice(foundSlice.length - upperIndex);\r\n      foundSlice.push(...sliced);\r\n    } else if(lowerIndex !== -1) {  // ([1, 2, 3] | [-1, 0, 1]) -> [-1, 0, 1, 2, 3]\r\n      const sliced = slice.slice(0, slice.length - lowerIndex - 1);\r\n      foundSlice.unshift(...sliced);\r\n    } else {\r\n      let insertIndex = 0;\r\n      for(const length = this.slices.length; insertIndex < length; ++insertIndex) { // * maybe should iterate from the end, could be faster ?\r\n        const s = this.slices[insertIndex];\r\n        if(compareValue(slice[0], s[0]) === 1) {\r\n          break;\r\n        }\r\n      }\r\n\r\n      this.slices.splice(insertIndex, 0, this.constructSlice(...slice));\r\n      foundSliceIndex = insertIndex;\r\n    }\r\n\r\n    if(flatten) {\r\n      return this.flatten(foundSliceIndex);\r\n    }\r\n  }\r\n\r\n  private flatten(foundSliceIndex: number) {\r\n    if(this.slices.length >= 2) {\r\n      for(let i = 0, length = this.slices.length; i < (length - 1); ++i) {\r\n        const prevSlice = this.slices[i];\r\n        const nextSlice = this.slices[i + 1];\r\n  \r\n        const upperIndex = prevSlice.indexOf(nextSlice[0]);\r\n        if(upperIndex !== -1) {\r\n          prevSlice.setEnd(nextSlice.end);\r\n          this.slices.splice(i + 1, 1);\r\n\r\n          if(i < foundSliceIndex) {\r\n            --foundSliceIndex;\r\n          }\r\n\r\n          --length; // respect array bounds\r\n          --i;      // repeat from the same place\r\n  \r\n          this.insertSlice(nextSlice, false);\r\n        }\r\n      }\r\n    }\r\n\r\n    return this.slices[foundSliceIndex];\r\n  }\r\n\r\n  // * \r\n  \r\n  get first() {\r\n    return this.slices[0];\r\n  }\r\n  \r\n  get last() {\r\n    return this.slices[this.slices.length - 1];\r\n  }\r\n\r\n  get slice() {\r\n    return this.first;\r\n  }\r\n\r\n  get length() {\r\n    return this.slice.length;\r\n  }\r\n\r\n  public findSlice(item: T) {\r\n    for(let i = 0, length = this.slices.length; i < length; ++i) {\r\n      const slice = this.slices[i];\r\n      const index = slice.indexOf(item);\r\n      if(index !== -1) {\r\n        return {slice, index};\r\n      }\r\n    }\r\n    \r\n    return undefined;\r\n  }\r\n\r\n  public findSliceOffset(maxId: T) {\r\n    let slice: Slice<T>;\r\n    for(let i = 0; i < this.slices.length; ++i) {\r\n      let offset = 0;\r\n      slice = this.slices[i];\r\n      if(slice.length < 2) {\r\n        continue;\r\n      }\r\n      \r\n      for(; offset < slice.length; ++offset) {\r\n        if(compareValue(maxId, slice[offset]) >= 0) {\r\n          /* if(!offset) { // because can't find 3 in [[5,4], [2,1]]\r\n            return undefined;\r\n          } */\r\n\r\n          return {\r\n            slice, \r\n            offset: maxId === slice[offset] ? offset : offset - 1\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    if(slice && slice.isEnd(SliceEnd.Top)) {\r\n      return {\r\n        slice,\r\n        offset: slice.length\r\n      };\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  // * https://core.telegram.org/api/offsets\r\n  public sliceMe(offsetId: T, add_offset: number, limit: number) {\r\n    let slice = this.slice;\r\n    let offset = 0;\r\n    let sliceOffset = 0;\r\n\r\n    if(offsetId) {\r\n      const pos = this.findSliceOffset(offsetId);\r\n      if(!pos) {\r\n        return undefined;\r\n      }\r\n\r\n      slice = pos.slice;\r\n      offset = sliceOffset = pos.offset;\r\n\r\n      if(slice.includes(offsetId)) {\r\n        sliceOffset += 1;\r\n      }\r\n\r\n      /* if(slice.includes(offsetId) && add_offset < 0) {\r\n        add_offset += 1;\r\n      } */\r\n    }\r\n\r\n    let sliceStart = Math.max(sliceOffset + add_offset, 0);\r\n    let sliceEnd = sliceOffset + add_offset + limit;\r\n    //const fixHalfBackLimit = add_offset && !(limit / add_offset % 2) && (sliceEnd % 2) ? 1 : 0;\r\n    //sliceEnd += fixHalfBackLimit;\r\n\r\n    const sliced = slice.slice(sliceStart, sliceEnd) as Slice<T>;\r\n\r\n    const topWasMeantToLoad = add_offset < 0 ? limit + add_offset : limit;\r\n    const bottomWasMeantToLoad = Math.abs(add_offset);\r\n\r\n    // can use 'slice' here to check because if it's end, then 'sliced' is out of 'slice'\r\n    // useful when there is only 1 message in chat on its reopening\r\n    const topFulfilled = (slice.length - sliceOffset) >= topWasMeantToLoad || (slice.isEnd(SliceEnd.Top) ? (sliced.setEnd(SliceEnd.Top), true) : false);\r\n    const bottomFulfilled = (sliceOffset - bottomWasMeantToLoad) >= 0 || (slice.isEnd(SliceEnd.Bottom) ? (sliced.setEnd(SliceEnd.Bottom), true) : false);\r\n\r\n    // if(topFulfilled) sliced.isEnd(SliceEnd.Top);\r\n    // if(bottomFulfilled) sliced.isEnd(SliceEnd.Bottom);\r\n\r\n    return {\r\n      slice: sliced, \r\n      offsetIdOffset: offset,\r\n      fulfilled: SliceEnd.None | (topFulfilled && bottomFulfilled ? SliceEnd.Both : ((topFulfilled ? SliceEnd.Top : SliceEnd.None) | (bottomFulfilled ? SliceEnd.Bottom : SliceEnd.None)))\r\n    };\r\n  }\r\n\r\n  public unshift(...items: T[]) {\r\n    let slice = this.first;\r\n    if(!slice.length) {\r\n      slice.setEnd(SliceEnd.Bottom);\r\n    } else if(!slice.isEnd(SliceEnd.Bottom)) {\r\n      slice = this.constructSlice();\r\n      slice.setEnd(SliceEnd.Bottom);\r\n      this.slices.unshift(slice);\r\n    }\r\n\r\n    slice.unshift(...items);\r\n  }\r\n\r\n  public push(...items: T[]) {\r\n    let slice = this.last;\r\n    if(!slice.length) {\r\n      slice.setEnd(SliceEnd.Top);\r\n    } else if(!slice.isEnd(SliceEnd.Top)) {\r\n      slice = this.constructSlice();\r\n      slice.setEnd(SliceEnd.Top);\r\n      this.slices.push(slice);\r\n    }\r\n\r\n    slice.push(...items);\r\n  }\r\n\r\n  public delete(item: T) {\r\n    const found = this.findSlice(item);\r\n    if(found) {\r\n      found.slice.splice(found.index, 1);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  public deleteSlice(slice: Slice<T>) {\r\n    indexOfAndSplice(this.slices, slice);\r\n  }\r\n\r\n  public toJSON() {\r\n    const slices: SlicedArraySerialized<T>['slices'] = this.slices.map((slice) => {\r\n      return {\r\n        values: slice.slice(),\r\n        isEnd: slice.getEnds()\r\n      };\r\n    });\r\n\r\n    const serialized: SlicedArraySerialized<T> = {\r\n      slices\r\n    };\r\n\r\n    return JSON.stringify(serialized);\r\n  }\r\n\r\n  public static fromJSON<T extends ItemType>(json: string) {\r\n    const parsed: SlicedArraySerialized<T> = JSON.parse(json);\r\n    const sliced = new SlicedArray<T>();\r\n    parsed.slices.forEach((slice) => {\r\n      const inserted = sliced.insertSlice(slice.values) || sliced.first;\r\n      if(slice.isEnd.top) inserted.setEnd(SliceEnd.Top);\r\n      if(slice.isEnd.bottom) inserted.setEnd(SliceEnd.Bottom);\r\n    });\r\n\r\n    return sliced;\r\n  }\r\n}\r\n\r\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.SlicedArray = SlicedArray);\r\n","import compareLong from \"./long/compareLong\";\r\n\r\nexport default function compareValue(val1: string | number, val2: typeof val1) {\r\n  if((val1 as number).toExponential) {\r\n    const diff = (val1 as number) - (val2 as number);\r\n    return diff < 0 ? -1 : (diff > 0 ? 1 : 0);\r\n  }\r\n\r\n  return compareLong(val1 as string, val2 as string);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport default function compareLong(str1: string, str2: string) {\r\n  const str1Length = str1.length;\r\n  if(str1Length !== str2.length) {\r\n    const diff = str1Length - str2.length;\r\n    return diff < 0 ? -1 : (diff > 0 ? 1 : 0);\r\n  }\r\n\r\n  const maxPartLength = 15;\r\n  for(let i = 0; i < str1Length; i += maxPartLength) {\r\n    const v1 = +str1.slice(i, i + maxPartLength);\r\n    const v2 = +str2.slice(i, i + maxPartLength);\r\n    const diff = v1 - v2;\r\n    if(diff) {\r\n      return diff;\r\n    }\r\n  }\r\n\r\n  return 0;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { ChannelParticipant, ChatParticipant } from \"../../../../layer\";\r\nimport getPeerId from \"../peers/getPeerId\";\r\n\r\nexport default function getParticipantPeerId(participant: ChannelParticipant | ChatParticipant): PeerId {\r\n  const peerId = (participant as ChannelParticipant.channelParticipantBanned).peer ? \r\n    getPeerId((participant as ChannelParticipant.channelParticipantBanned).peer) : \r\n    (participant as ChatParticipant.chatParticipant).user_id.toPeerId();\r\n  return peerId;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { Chat, ChatAdminRights, ChatBannedRights } from \"../../../../layer\";\r\nimport { ChatRights } from \"../../appChatsManager\";\r\n\r\n/**\r\n * Check the user's ability to do an action in chat\r\n * @param id \r\n * @param action creator can still send messages to left channel. so this function shows server rights. see canSendToPeer for local rights in messages manager.\r\n * @param rights do not provide this parameter when checking rights for self\r\n * @param isThread \r\n * @returns \r\n */\r\nexport default function hasRights(chat: Chat, action: ChatRights, rights?: ChatAdminRights | ChatBannedRights, isThread?: boolean) {\r\n  if(chat._ === 'chatEmpty') return false;\r\n\r\n  if((chat as Chat.chat).pFlags.deactivated && action !== 'view_messages') {\r\n    return false;\r\n  }\r\n\r\n  const isCheckingRightsForSelf = rights === undefined;\r\n  if((chat as Chat.chat).pFlags.creator && isCheckingRightsForSelf) {\r\n    return true;\r\n  }\r\n\r\n  if(chat._ === 'chatForbidden' ||\r\n      chat._ === 'channelForbidden' ||\r\n      // (chat as any).pFlags.kicked ||\r\n      (chat.pFlags.left && !(chat as Chat.channel).pFlags.megagroup)) {\r\n    return false;\r\n  }\r\n\r\n  // const adminRights = chat.admin_rights;\r\n  // const bannedRights = (chat as Chat.channel).banned_rights || chat.default_banned_rights;\r\n\r\n  if(!rights) {\r\n    rights = chat.admin_rights || (chat as Chat.channel).banned_rights || chat.default_banned_rights;\r\n\r\n    if(!rights) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  let myFlags: Partial<{[flag in keyof ChatBannedRights['pFlags'] | keyof ChatAdminRights['pFlags']]: true}> = {};\r\n  if(rights) {\r\n    myFlags = rights.pFlags as any;\r\n  }\r\n\r\n  // const adminFlags = adminRights?.pFlags || {};\r\n  // const bannedFlags = bannedRights?.pFlags || {};\r\n\r\n  switch(action) {\r\n    case 'embed_links':\r\n    case 'send_games':\r\n    case 'send_gifs':\r\n    case 'send_inline':\r\n    case 'send_media':\r\n    case 'send_messages':\r\n    case 'send_polls':\r\n    case 'send_stickers': {\r\n      if(!isThread && chat.pFlags.left) {\r\n        return false;\r\n      }\r\n\r\n      if(rights._ === 'chatBannedRights' && myFlags[action]) {\r\n        return false;\r\n      }\r\n\r\n      if(chat._ === 'channel') {\r\n        if(!chat.pFlags.megagroup && !myFlags.post_messages) {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      break;\r\n    }\r\n\r\n    // * revoke foreign messages\r\n    case 'delete_messages':\r\n    case 'manage_call': {\r\n      return !!myFlags[action];\r\n    }\r\n\r\n    case 'pin_messages': {\r\n      return rights._ === 'chatAdminRights' ? myFlags[action] || !!myFlags.post_messages : !myFlags[action];\r\n    }\r\n\r\n    // case 'change_info': {\r\n      // return adminRights || isCheckingRightsForSelf ? adminFlags[action] : !myFlags[action];\r\n    // }\r\n\r\n    case 'change_info':\r\n    case 'invite_users': {\r\n      return rights._ === 'chatAdminRights' ? myFlags[action] : !myFlags[action];\r\n    }\r\n\r\n    // * only creator can do that\r\n    case 'change_type':\r\n    case 'delete_chat': {\r\n      return false;\r\n    }\r\n\r\n    case 'ban_users':\r\n    case 'change_permissions': {\r\n      return rights._ === 'chatAdminRights' && !!myFlags['ban_users'];\r\n    }\r\n\r\n    case 'view_participants': {\r\n      return !!(chat._ === 'chat' || !chat.pFlags.broadcast || chat.pFlags.creator || chat.admin_rights);\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { Dialog } from \"../../../../layer\";\r\nimport getDialogIndexKey from \"./getDialogIndexKey\";\r\n\r\nexport default function getDialogIndex(\r\n  dialog: Dialog.dialog, \r\n  indexKey: ReturnType<typeof getDialogIndexKey> = getDialogIndexKey(dialog.folder_id)\r\n) {\r\n  return dialog && dialog[indexKey];\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport type { DialogFilter } from \"../../../../layer\";\r\n\r\nexport default function getDialogIndexKey(orderIndex?: DialogFilter.dialogFilter['orderIndex']) {\r\n  return `index_${orderIndex}` as const;\r\n  // return filterId !== undefined && filterId > 1 ? `filter_${filterId}` as const : 'main' as const;\r\n  // const indexStr = filterId > 1 ? \r\n  //   `index_${filterId}` as const : \r\n  //   'index' as const;\r\n\r\n  // return indexStr;\r\n}\r\n","import { MessagesBotResults } from \"../../../../layer\";\r\n\r\nexport default function generateQId(queryId: MessagesBotResults.messagesBotResults['query_id'], resultId: string) {\r\n  return queryId + '_' + resultId;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { Message, MessageMedia, MessageEntity, MessageAction } from \"../../../../layer\";\r\nimport matchUrl from \"../../../richTextProcessor/matchUrl\";\r\nimport type { MyDocument } from \"../../appDocsManager\";\r\nimport type { MyInputMessagesFilter, MyMessage } from \"../../appMessagesManager\";\r\n\r\nexport default function filterMessagesByInputFilter(inputFilter: MyInputMessagesFilter, history: Array<Message.message | Message.messageService>, limit: number) {\r\n  if(inputFilter === 'inputMessagesFilterEmpty') {\r\n    return history;\r\n  }\r\n\r\n  const foundMsgs: MyMessage[] = [];\r\n  if(!history.length) {\r\n    return foundMsgs;\r\n  }\r\n\r\n  let filtering = true;\r\n  const neededContents: Partial<{\r\n    [messageMediaType in MessageMedia['_']]: boolean\r\n  }> & Partial<{\r\n    avatar: boolean,\r\n    url: boolean\r\n  }> = {},\r\n    neededDocTypes: MyDocument['type'][] = [], \r\n    excludeDocTypes: MyDocument['type'][] = []/* ,\r\n    neededFlags: string[] = [] */;\r\n\r\n  switch(inputFilter) {\r\n    case 'inputMessagesFilterPhotos':\r\n      neededContents['messageMediaPhoto'] = true;\r\n      break;\r\n\r\n    case 'inputMessagesFilterPhotoVideo':\r\n      neededContents['messageMediaPhoto'] = true;\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('video');\r\n      break;\r\n\r\n    case 'inputMessagesFilterVideo':\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('video');\r\n      break;\r\n\r\n    case 'inputMessagesFilterDocument':\r\n      neededContents['messageMediaDocument'] = true;\r\n      // excludeDocTypes.push('video');\r\n      neededDocTypes.push(undefined, 'photo', 'pdf');\r\n      break;\r\n\r\n    case 'inputMessagesFilterVoice':\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('voice');\r\n      break;\r\n\r\n    case 'inputMessagesFilterRoundVoice':\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('round', 'voice');\r\n      break;\r\n\r\n    case 'inputMessagesFilterRoundVideo':\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('round');\r\n      break;\r\n\r\n    case 'inputMessagesFilterMusic':\r\n      neededContents['messageMediaDocument'] = true;\r\n      neededDocTypes.push('audio');\r\n      break;\r\n\r\n    case 'inputMessagesFilterUrl':\r\n      neededContents['url'] = true;\r\n      break;\r\n\r\n    case 'inputMessagesFilterChatPhotos':\r\n      neededContents['avatar'] = true;\r\n      break;\r\n\r\n    /* case 'inputMessagesFilterPinned':\r\n      neededFlags.push('pinned');\r\n      break; */\r\n\r\n    /* case 'inputMessagesFilterMyMentions':\r\n      neededContents['mentioned'] = true;\r\n      break; */\r\n\r\n    default:\r\n      filtering = false;\r\n      break;\r\n      /* return Promise.resolve({\r\n        count: 0,\r\n        next_rate: 0,\r\n        history: [] as number[]\r\n      }); */\r\n  }\r\n\r\n  if(!filtering) {\r\n    return foundMsgs;\r\n  }\r\n\r\n  for(let i = 0, length = history.length; i < length; ++i) {\r\n    const message: Message.message | Message.messageService = history[i];\r\n    if(!message) continue;\r\n\r\n    //|| (neededContents['mentioned'] && message.totalEntities.find((e: any) => e._ === 'messageEntityMention'));\r\n\r\n    let found = false;\r\n    if(message._ === 'message') {\r\n      if(message.media && neededContents[message.media._]/*  && !message.fwd_from */) {\r\n        const doc = (message.media as MessageMedia.messageMediaDocument).document as MyDocument;\r\n        if(doc && \r\n          (\r\n            (neededDocTypes.length && !neededDocTypes.includes(doc.type)) || \r\n            excludeDocTypes.includes(doc.type)\r\n          )\r\n        ) {\r\n          continue;\r\n        }\r\n\r\n        found = true;\r\n      } else if(neededContents['url'] && message.message) {\r\n        const goodEntities = ['messageEntityTextUrl', 'messageEntityUrl'];\r\n        if((message.totalEntities as MessageEntity[]).find((e) => goodEntities.includes(e._)) || matchUrl(message.message)) {\r\n          found = true;\r\n        }\r\n      }\r\n    } else if(neededContents['avatar'] && \r\n      message.action && \r\n      ([\r\n        'messageActionChannelEditPhoto' as const, \r\n        'messageActionChatEditPhoto' as const, \r\n        'messageActionChannelEditVideo' as const, \r\n        'messageActionChatEditVideo' as const\r\n      ] as MessageAction['_'][]).includes(message.action._)) {\r\n      found = true;\r\n    }/*  else if(neededFlags.find((flag) => message.pFlags[flag])) {\r\n      found = true;\r\n    } */\r\n\r\n    if(found) {\r\n      foundMsgs.push(message);\r\n      if(foundMsgs.length >= limit) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return foundMsgs;\r\n}\r\n","import assumeType from \"../../../../helpers/assumeType\";\r\nimport { Message, MessageEntity } from \"../../../../layer\";\r\n\r\nexport default function getAlbumText(messages: Message.message[]) {\r\n  let foundMessages = 0, message: string, totalEntities: MessageEntity[], entities: MessageEntity[];\r\n  for(const m of messages) {\r\n    assumeType<Message.message>(m);\r\n    if(m.message) {\r\n      if(++foundMessages > 1) break;\r\n      message = m.message;\r\n      totalEntities = m.totalEntities;\r\n      entities = m.entities;\r\n    }\r\n  }\r\n\r\n  if(foundMessages > 1) {\r\n    message = undefined;\r\n    totalEntities = undefined;\r\n    entities = undefined;\r\n  }\r\n\r\n  return {message, entities, totalEntities};\r\n}\r\n","import isObject from \"../../../../helpers/object/isObject\";\r\nimport { InputPeer, Peer } from \"../../../../layer\";\r\nimport { NULL_PEER_ID } from \"../../../mtproto/mtproto_config\";\r\n\r\nexport default function getPeerId(peerId: {user_id: UserId} | {channel_id: ChatId} | {chat_id: ChatId} | InputPeer | PeerId | string): PeerId {\r\n  if(peerId !== undefined && ((peerId as string).isPeerId ? (peerId as string).isPeerId() : false)) return peerId as PeerId;\r\n  // if(typeof(peerId) === 'string' && /^[uc]/.test(peerId)) return peerId as PeerId;\r\n  // if(typeof(peerId) === 'number') return peerId;\r\n  else if(isObject(peerId)) {\r\n    const userId = (peerId as Peer.peerUser).user_id;\r\n    if(userId !== undefined) {\r\n      return userId.toPeerId(false);\r\n    }\r\n\r\n    const chatId = (peerId as Peer.peerChannel).channel_id || (peerId as Peer.peerChat).chat_id;\r\n    if(chatId !== undefined) {\r\n      return chatId.toPeerId(true);\r\n    }\r\n\r\n    return NULL_PEER_ID; // maybe it is an inputPeerSelf\r\n  // } else if(!peerId) return 'u0';\r\n  } else if(!peerId) return NULL_PEER_ID;\r\n  \r\n  const isUser = (peerId as string).charAt(0) === 'u';\r\n  const peerParams = (peerId as string).substr(1).split('_');\r\n\r\n  return isUser ? peerParams[0].toPeerId() : (peerParams[0] || '').toPeerId(true);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { User } from \"../../../../layer\";\r\nimport { REPLIES_PEER_ID } from \"../../../mtproto/mtproto_config\";\r\n\r\nexport default function canSendToUser(user: User.user) {\r\n  return !user.pFlags.deleted && user.id.toPeerId() !== REPLIES_PEER_ID;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport enum ConnectionStatus {\r\n  Connected,\r\n  Connecting,\r\n  Closed,\r\n  TimedOut\r\n};\r\n\r\nexport type ConnectionStatusChange = {\r\n  _: 'networkerStatus', \r\n  status: ConnectionStatus,\r\n  dcId: number,\r\n  name: string,\r\n  isFileNetworker: boolean,\r\n  isFileDownload: boolean,\r\n  isFileUpload: boolean,\r\n  retryAt?: number\r\n};\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { MessageEntity } from \"../../layer\";\r\n\r\nexport default function fixEmoji(text: string, entities?: MessageEntity[]) {\r\n  /* if(!IS_EMOJI_SUPPORTED) {\r\n    return text;\r\n  } */\r\n  // '$`\\ufe0f'\r\n\r\n  text = text.replace(/[\\u2640\\u2642\\u2764](?!\\ufe0f)/g, (match, offset, string) => {\r\n    if(entities) {\r\n      const length = match.length;\r\n\r\n      offset += length;\r\n      entities.forEach((entity) => {\r\n        const end = entity.offset + entity.length;\r\n        if(end === offset) { // current entity\r\n          entity.length += length;\r\n        } else if(end > offset) {\r\n          entity.offset += length;\r\n        }\r\n      });\r\n    }\r\n    \r\n    // console.log([match, offset, string]);\r\n    return match + '\\ufe0f';\r\n  });\r\n\r\n  return text;\r\n}\r\n","import { URL_REG_EXP } from \".\";\r\n\r\nexport default function matchUrl(text: string) {\r\n  return !text ? null : text.match(URL_REG_EXP);\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n * \r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport { MARKDOWN_ENTITIES, MARKDOWN_REG_EXP } from \".\";\r\nimport { MessageEntity } from \"../../layer\";\r\nimport combineSameEntities from \"./combineSameEntities\";\r\nimport findConflictingEntity from \"./findConflictingEntity\";\r\nimport mergeEntities from \"./mergeEntities\";\r\n\r\nexport default function parseMarkdown(raw: string, currentEntities: MessageEntity[], noTrim?: boolean): string {\r\n  /* if(!markdownTestRegExp.test(text)) {\r\n    return noTrim ? text : text.trim();\r\n  } */\r\n\r\n  const entities: MessageEntity[] = [];\r\n  let pushedEntity = false;\r\n  const pushEntity = (entity: MessageEntity) => !findConflictingEntity(currentEntities, entity) ? (entities.push(entity), pushedEntity = true) : pushedEntity = false;\r\n\r\n  const newTextParts: string[] = [];\r\n  let rawOffset = 0, match;\r\n  while(match = raw.match(MARKDOWN_REG_EXP)) {\r\n    const matchIndex = rawOffset + match.index;\r\n    newTextParts.push(raw.substr(0, match.index));\r\n    const text = (match[3] || match[8] || match[11] || match[13]);\r\n    rawOffset -= text.length;\r\n    //text = text.replace(/^\\s+|\\s+$/g, '');\r\n    rawOffset += text.length;\r\n\r\n    let entity: MessageEntity;\r\n    pushedEntity = false;\r\n    if(text.match(/^`*$/)) {\r\n      newTextParts.push(match[0]);\r\n    } else if(match[3]) { // pre\r\n      entity = {\r\n        _: 'messageEntityPre',\r\n        language: '',\r\n        offset: matchIndex + match[1].length,\r\n        length: text.length\r\n      };\r\n\r\n      if(pushEntity(entity)) {\r\n        if(match[5] === '\\n') {\r\n          match[5] = '';\r\n          rawOffset -= 1;\r\n        }\r\n\r\n        newTextParts.push(match[1] + text + match[5]);\r\n        \r\n        rawOffset -= match[2].length + match[4].length;\r\n      }\r\n    } else if(match[7]) { // code|italic|bold\r\n      const isSOH = match[6] === '\\x01';\r\n\r\n      entity = {\r\n        _: MARKDOWN_ENTITIES[match[7]] as (MessageEntity.messageEntityBold | MessageEntity.messageEntityCode | MessageEntity.messageEntityItalic | MessageEntity.messageEntitySpoiler)['_'],\r\n        //offset: matchIndex + match[6].length,\r\n        offset: matchIndex + (isSOH ? 0 : match[6].length),\r\n        length: text.length\r\n      };\r\n\r\n      if(pushEntity(entity)) {\r\n        if(!isSOH) {\r\n          newTextParts.push(match[6] + text + match[9]);\r\n        } else {\r\n          newTextParts.push(text);\r\n        }\r\n\r\n        rawOffset -= match[7].length * 2 + (isSOH ? 2 : 0);\r\n      }\r\n    } else if(match[11]) { // custom mention\r\n      entity = {\r\n        _: 'messageEntityMentionName',\r\n        user_id: match[10].toUserId(),\r\n        offset: matchIndex,\r\n        length: text.length\r\n      };\r\n      \r\n      if(pushEntity(entity)) {\r\n        newTextParts.push(text);\r\n        \r\n        rawOffset -= match[0].length - text.length;\r\n      }\r\n    } else if(match[12]) { // text url\r\n      entity = {\r\n        _: 'messageEntityTextUrl',\r\n        url: match[14],\r\n        offset: matchIndex,\r\n        length: text.length\r\n      };\r\n      \r\n      if(pushEntity(entity)) {\r\n        newTextParts.push(text);\r\n\r\n        rawOffset -= match[12].length - text.length;\r\n      }\r\n    }\r\n\r\n    if(!pushedEntity) {\r\n      newTextParts.push(match[0]);\r\n    }\r\n\r\n    raw = raw.substr(match.index + match[0].length);\r\n    rawOffset += match.index + match[0].length;\r\n  }\r\n\r\n  newTextParts.push(raw);\r\n  let newText = newTextParts.join('');\r\n  if(!newText.replace(/\\s+/g, '').length) {\r\n    newText = raw;\r\n    entities.splice(0, entities.length);\r\n  }\r\n\r\n  // ! idk what it was here for\r\n  // if(!entities.length && !noTrim) {\r\n  //   newText = newText.trim();\r\n  // }\r\n\r\n  mergeEntities(currentEntities, entities);\r\n  combineSameEntities(currentEntities);\r\n\r\n  let length = newText.length;\r\n  if(!noTrim) {\r\n    // trim left\r\n    newText = newText.replace(/^\\s*/, '');\r\n\r\n    let diff = length - newText.length;\r\n    if(diff) {\r\n      currentEntities.forEach((entity) => {\r\n        entity.offset = Math.max(0, entity.offset - diff);\r\n      });\r\n    }\r\n\r\n    // trim right\r\n    newText = newText.replace(/\\s*$/, '');\r\n    diff = length - newText.length;\r\n    length = newText.length;\r\n    if(diff) {\r\n      currentEntities.forEach((entity) => {\r\n        if((entity.offset + entity.length) > length) {\r\n          entity.length = length - entity.offset;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  return newText;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport { MessageEntity } from \"../../layer\";\r\nimport encodeSpoiler from \"./encodeSpoiler\";\r\n\r\n/**\r\n * ! This function is still unsafe to use with .innerHTML\r\n */\r\nexport default function wrapPlainText(text: string, entities: MessageEntity[] = []) {\r\n  entities.forEach((entity) => {\r\n    if(entity._ === 'messageEntitySpoiler') {\r\n      text = encodeSpoiler(text, entity).text;\r\n    }\r\n  });\r\n\r\n  return text;\r\n  // if(entities?.length) {\r\n  //   entities = entities.filter((entity) => entity._ === 'messageEntitySpoiler');\r\n  // }\r\n\r\n  // return wrapRichText(text, {\r\n  //   entities, \r\n  //   noEncoding: true,\r\n  //   noTextFormat: true,\r\n  //   noLinebreaks: true,\r\n  //   noLinks: true\r\n  // }).textContent;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n * \r\n * Originally from:\r\n * https://github.com/zhukov/webogram\r\n * Copyright (C) 2014 Igor Zhukov <igor.beatle@gmail.com>\r\n * https://github.com/zhukov/webogram/blob/master/LICENSE\r\n */\r\n\r\nimport { processSearchText, ProcessSearchTextOptions } from '../helpers/cleanSearchText';\r\nimport flatten from '../helpers/array/flatten';\r\n\r\nexport default class SearchIndex<SearchWhat> {\r\n  private fullTexts: Map<SearchWhat, string> = new Map();\r\n\r\n  // minChars can be 0 because it requires at least one word (one symbol) to be found\r\n  constructor(private options?: ProcessSearchTextOptions, private minChars = 0) {\r\n  }\r\n\r\n  public indexObject(id: SearchWhat, searchText: string) {\r\n    /* if(searchIndex.fullTexts.hasOwnProperty(id)) {\r\n      return false;\r\n    } */\r\n\r\n    if(this.options && searchText.trim()) {\r\n      searchText = processSearchText(searchText, this.options);\r\n    }\r\n\r\n    if(!searchText) {\r\n      this.fullTexts.delete(id);\r\n      return false;\r\n    }\r\n\r\n    this.fullTexts.set(id, searchText);\r\n    \r\n    /* const shortIndexes = searchIndex.shortIndexes;\r\n    searchText.split(' ').forEach((searchWord) => {\r\n      let len = Math.min(searchWord.length, 3),\r\n        wordPart, i;\r\n      for(i = 1; i <= len; i++) {\r\n        wordPart = searchWord.substr(0, i);\r\n        if(shortIndexes[wordPart] === undefined) {\r\n          shortIndexes[wordPart] = [id];\r\n        } else {\r\n          shortIndexes[wordPart].push(id);\r\n        }\r\n      }\r\n    }); */\r\n  }\r\n\r\n  private _search(query: string) {\r\n    const newFoundObjs: Array<{fullText: string, fullTextLength: number, what: SearchWhat, foundChars: number}> = [];\r\n    const fullTexts = this.fullTexts;\r\n    const queryWords = query.split(' ');\r\n    const queryWordsLength = queryWords.length;\r\n    fullTexts.forEach((fullText, what) => {\r\n      let found = true;\r\n      let foundChars = 0;\r\n      for(let i = 0; i < queryWordsLength; ++i) { // * verify that all words are found\r\n        const word = queryWords[i];\r\n        const idx = fullText.indexOf(word);\r\n        if(idx === -1 || (idx !== 0 && fullText[idx - 1] !== ' '/*  && !badCharsRe.test(fullText[idx - 1]) */)) { // * search only from word beginning\r\n          found = false;\r\n          break;\r\n        }\r\n\r\n        foundChars += word.length;\r\n      }\r\n\r\n      if(found) {\r\n        foundChars += queryWordsLength - 1;\r\n        const fullTextLength = fullText.length;\r\n        if(this.minChars <= foundChars || fullTextLength <= foundChars) {\r\n          newFoundObjs.push({fullText, fullTextLength, what, foundChars});\r\n        }\r\n      }\r\n    });\r\n\r\n    return newFoundObjs;\r\n  }\r\n\r\n  public search(query: string) {\r\n    if(this.options) {\r\n      query = processSearchText(query, this.options);\r\n    }\r\n\r\n    const queries = query.split('\\x01');\r\n    const newFoundObjs = flatten(queries.map((query) => this._search(query)));\r\n\r\n    newFoundObjs.sort((a, b) => a.fullTextLength - b.fullTextLength || b.foundChars - a.foundChars);\r\n\r\n    //newFoundObjs.sort((a, b) => a.fullText.localeCompare(b.fullText));\r\n    const newFoundObjs2: Set<SearchWhat> = new Set(newFoundObjs.map((o) => o.what));\r\n\r\n    return newFoundObjs2;\r\n  }\r\n}\r\n","export default function flatten<T>(arr: T[][]): T[] {\r\n  return arr.reduce((acc, val) => (acc.push(...val), acc), []);\r\n}\r\n"],"names":["LazyLoadQueueBase","constructor","parallelLimit","queueId","queue","inProcess","Set","lockPromise","unlockResolve","log","this","processQueue","_processQueue","clear","length","lock","Promise","resolve","reject","unlock","processItem","item","add","loadItem","err","includes","error","delete","load","getItem","shift","addElement","method","el","size","push","unshift","filterUnique","arr","insertInDescendSortedArray","array","element","getProperty","pos","property","sortProperty","undefined","indexOf","prev","next","splice","len","i","console","assumeType","x","bytesCmp","bytes1","bytes2","bytesFromHex","hexString","bytes","Uint8Array","Math","ceil","start","parseInt","charAt","substr","convertToUint8Array","TextEncoder","encode","callbackify","smth","callback","then","getMiddleware","cleanupObj","cleaned","clean","get","additionalCallback","_cleanupObj","getObjectKeysAndSort","object","sort","ids","Map","keys","Object","map","a","b","debounce","fn","ms","shouldRunFirst","shouldRunLast","waitingTimeout","waitingPromise","hadNewCall","invoke","args","_resolve","_reject","apply","clearTimeout","_waitingTimeout","catch","SliceEnd","compareValue","val1","val2","toExponential","diff","str1","str2","str1Length","slice","compareLong","SlicedArray","sliceConstructor","getSliceConstructor","first","constructSlice","slices","static","slicedArray","Array","end","None","isEnd","side","Top","last","Bottom","Both","setEnd","getEnds","top","bottom","both","unsetEnd","deleteCount","items","ret","super","idx","insertSlice","flatten","lowerBound","upperBound","foundSlice","lowerIndex","upperIndex","foundSliceIndex","sliced","insertIndex","s","prevSlice","nextSlice","findSlice","index","findSliceOffset","maxId","offset","sliceMe","offsetId","add_offset","limit","sliceOffset","sliceStart","max","sliceEnd","topWasMeantToLoad","bottomWasMeantToLoad","abs","topFulfilled","bottomFulfilled","offsetIdOffset","fulfilled","found","deleteSlice","indexOfAndSplice","toJSON","serialized","values","JSON","stringify","json","parsed","parse","forEach","inserted","getParticipantPeerId","participant","peer","user_id","toPeerId","hasRights","chat","action","rights","isThread","_","pFlags","deactivated","isCheckingRightsForSelf","creator","left","megagroup","admin_rights","banned_rights","default_banned_rights","myFlags","post_messages","broadcast","getDialogIndex","dialog","indexKey","folder_id","getDialogIndexKey","orderIndex","generateQId","queryId","resultId","filterMessagesByInputFilter","inputFilter","history","foundMsgs","filtering","neededContents","neededDocTypes","excludeDocTypes","message","media","doc","document","type","goodEntities","totalEntities","find","e","getAlbumText","messages","entities","foundMessages","m","getPeerId","peerId","isPeerId","userId","chatId","channel_id","chat_id","isUser","peerParams","split","canSendToUser","user","deleted","id","ConnectionStatus","fixEmoji","text","replace","match","string","entity","matchUrl","parseMarkdown","raw","currentEntities","noTrim","pushedEntity","pushEntity","newTextParts","rawOffset","matchIndex","language","isSOH","toUserId","url","newText","join","wrapPlainText","SearchIndex","options","minChars","fullTexts","indexObject","searchText","trim","set","_search","query","newFoundObjs","queryWords","queryWordsLength","fullText","what","foundChars","word","fullTextLength","search","reduce","acc","val","o"],"sourceRoot":""}